- name: ./smoketests.yml \ Basics \ Install
  commands:
    - command: go generate ../...
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: go install -a ..
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Basics \ Lex
  commands:
    - command: $(go env GOPATH)/bin/rpc -lex todo-simple.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - '{"type":"keyword","value":"option","pos":{"byte_no":6,"line_no":0,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":7,"line_no":0,"col_no":7}}'
            - '{"type":"identifier","value":"transport","pos":{"byte_no":16,"line_no":0,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":17,"line_no":0,"col_no":17}}'
            - '{"type":"value-string","value":"http","pos":{"byte_no":23,"line_no":0,"col_no":23}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":24,"line_no":0,"col_no":24}}'
            - '{"type":"keyword","value":"option","pos":{"byte_no":30,"line_no":1,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":31,"line_no":1,"col_no":7}}'
            - '{"type":"identifier","value":"encoding","pos":{"byte_no":39,"line_no":1,"col_no":15}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":40,"line_no":1,"col_no":16}}'
            - '{"type":"value-string","value":"json","pos":{"byte_no":46,"line_no":1,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":47,"line_no":1,"col_no":23}}'
            - '{"type":"keyword","value":"option","pos":{"byte_no":53,"line_no":2,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":54,"line_no":2,"col_no":7}}'
            - '{"type":"identifier","value":"ruby_module","pos":{"byte_no":65,"line_no":2,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":66,"line_no":2,"col_no":19}}'
            - '{"type":"value-string","value":"minitodo","pos":{"byte_no":76,"line_no":2,"col_no":29}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":77,"line_no":2,"col_no":30}}'
            - '{"type":"keyword","value":"option","pos":{"byte_no":83,"line_no":3,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":84,"line_no":3,"col_no":7}}'
            - '{"type":"identifier","value":"go_package","pos":{"byte_no":94,"line_no":3,"col_no":17}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":95,"line_no":3,"col_no":18}}'
            - '{"type":"value-string","value":"minitodo","pos":{"byte_no":105,"line_no":3,"col_no":28}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":106,"line_no":3,"col_no":29}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":107,"line_no":4,"col_no":1}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":111,"line_no":5,"col_no":4}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":112,"line_no":5,"col_no":5}}'
            - '{"type":"identifier","value":"Failure","pos":{"byte_no":119,"line_no":5,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":120,"line_no":5,"col_no":13}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":121,"line_no":5,"col_no":14}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":122,"line_no":5,"col_no":15}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":126,"line_no":6,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":132,"line_no":6,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":133,"line_no":6,"col_no":11}}'
            - '{"type":"identifier","value":"code","pos":{"byte_no":137,"line_no":6,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":138,"line_no":6,"col_no":16}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":142,"line_no":7,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":148,"line_no":7,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":149,"line_no":7,"col_no":11}}'
            - '{"type":"identifier","value":"description","pos":{"byte_no":160,"line_no":7,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":161,"line_no":7,"col_no":23}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":162,"line_no":8,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":163,"line_no":8,"col_no":2}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":164,"line_no":9,"col_no":1}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":168,"line_no":10,"col_no":4}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":169,"line_no":10,"col_no":5}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":177,"line_no":10,"col_no":13}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":178,"line_no":10,"col_no":14}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":179,"line_no":10,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":180,"line_no":10,"col_no":16}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":184,"line_no":11,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":190,"line_no":11,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":191,"line_no":11,"col_no":11}}'
            - '{"type":"identifier","value":"uuid","pos":{"byte_no":195,"line_no":11,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":196,"line_no":11,"col_no":16}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":200,"line_no":12,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":206,"line_no":12,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":207,"line_no":12,"col_no":11}}'
            - '{"type":"identifier","value":"description","pos":{"byte_no":218,"line_no":12,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":219,"line_no":12,"col_no":23}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":223,"line_no":13,"col_no":4}}'
            - '{"type":"keyword","value":"time","pos":{"byte_no":227,"line_no":13,"col_no":8}}'
            - '{"type":"whitespace","value":"   ","pos":{"byte_no":230,"line_no":13,"col_no":11}}'
            - '{"type":"identifier","value":"ctime","pos":{"byte_no":235,"line_no":13,"col_no":16}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":236,"line_no":13,"col_no":17}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":240,"line_no":14,"col_no":4}}'
            - '{"type":"keyword","value":"bool","pos":{"byte_no":244,"line_no":14,"col_no":8}}'
            - '{"type":"whitespace","value":"   ","pos":{"byte_no":247,"line_no":14,"col_no":11}}'
            - '{"type":"identifier","value":"completed","pos":{"byte_no":256,"line_no":14,"col_no":20}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":257,"line_no":14,"col_no":21}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":261,"line_no":15,"col_no":4}}'
            - '{"type":"keyword","value":"data","pos":{"byte_no":265,"line_no":15,"col_no":8}}'
            - '{"type":"whitespace","value":"   ","pos":{"byte_no":268,"line_no":15,"col_no":11}}'
            - '{"type":"identifier","value":"metadata","pos":{"byte_no":276,"line_no":15,"col_no":19}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":277,"line_no":15,"col_no":20}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":278,"line_no":16,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":279,"line_no":16,"col_no":2}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":280,"line_no":17,"col_no":1}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":283,"line_no":18,"col_no":3}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":284,"line_no":18,"col_no":4}}'
            - '{"type":"identifier","value":"List","pos":{"byte_no":288,"line_no":18,"col_no":8}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":289,"line_no":18,"col_no":9}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":290,"line_no":18,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":291,"line_no":18,"col_no":11}}'
            - '{"type":"keyword","value":"list","pos":{"byte_no":295,"line_no":18,"col_no":15}}'
            - '{"type":"type-arg-list-start","value":"\u003c","pos":{"byte_no":296,"line_no":18,"col_no":16}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":304,"line_no":18,"col_no":24}}'
            - '{"type":"type-arg-list-end","value":"\u003e","pos":{"byte_no":305,"line_no":18,"col_no":25}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":306,"line_no":18,"col_no":26}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":309,"line_no":19,"col_no":3}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":310,"line_no":19,"col_no":4}}'
            - '{"type":"identifier","value":"Get","pos":{"byte_no":313,"line_no":19,"col_no":7}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":314,"line_no":19,"col_no":8}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":320,"line_no":19,"col_no":14}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":321,"line_no":19,"col_no":15}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":322,"line_no":19,"col_no":16}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":330,"line_no":19,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":331,"line_no":19,"col_no":25}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":334,"line_no":20,"col_no":3}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":335,"line_no":20,"col_no":4}}'
            - '{"type":"identifier","value":"Put","pos":{"byte_no":338,"line_no":20,"col_no":7}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":339,"line_no":20,"col_no":8}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":347,"line_no":20,"col_no":16}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":348,"line_no":20,"col_no":17}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":349,"line_no":20,"col_no":18}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":357,"line_no":20,"col_no":26}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":358,"line_no":20,"col_no":27}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":361,"line_no":21,"col_no":3}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":362,"line_no":21,"col_no":4}}'
            - '{"type":"identifier","value":"Delete","pos":{"byte_no":368,"line_no":21,"col_no":10}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":369,"line_no":21,"col_no":11}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":375,"line_no":21,"col_no":17}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":376,"line_no":21,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":377,"line_no":21,"col_no":19}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":385,"line_no":21,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":386,"line_no":21,"col_no":28}}'
            - '{"type":"end-of-file","value":"","pos":{"byte_no":386,"line_no":22,"col_no":0}}'
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -lex todo-complex.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - '{"type":"keyword","value":"option","pos":{"byte_no":6,"line_no":0,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":7,"line_no":0,"col_no":7}}'
            - '{"type":"identifier","value":"go_import","pos":{"byte_no":16,"line_no":0,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":17,"line_no":0,"col_no":17}}'
            - '{"type":"value-string","value":"github.com/chakrit/rpc/examples","pos":{"byte_no":50,"line_no":0,"col_no":50}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":51,"line_no":0,"col_no":51}}'
            - '{"type":"keyword","value":"option","pos":{"byte_no":57,"line_no":1,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":58,"line_no":1,"col_no":7}}'
            - '{"type":"identifier","value":"go_package","pos":{"byte_no":68,"line_no":1,"col_no":17}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":69,"line_no":1,"col_no":18}}'
            - '{"type":"value-string","value":"examples","pos":{"byte_no":79,"line_no":1,"col_no":28}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":80,"line_no":1,"col_no":29}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":81,"line_no":2,"col_no":1}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":85,"line_no":3,"col_no":4}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":86,"line_no":3,"col_no":5}}'
            - '{"type":"identifier","value":"Failure","pos":{"byte_no":93,"line_no":3,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":94,"line_no":3,"col_no":13}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":95,"line_no":3,"col_no":14}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":96,"line_no":3,"col_no":15}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":100,"line_no":4,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":106,"line_no":4,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":107,"line_no":4,"col_no":11}}'
            - '{"type":"identifier","value":"code","pos":{"byte_no":111,"line_no":4,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":112,"line_no":4,"col_no":16}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":116,"line_no":5,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":122,"line_no":5,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":123,"line_no":5,"col_no":11}}'
            - '{"type":"identifier","value":"description","pos":{"byte_no":134,"line_no":5,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":135,"line_no":5,"col_no":23}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":136,"line_no":6,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":137,"line_no":6,"col_no":2}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":138,"line_no":7,"col_no":1}}'
            - '{"type":"keyword","value":"namespace","pos":{"byte_no":147,"line_no":8,"col_no":9}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":148,"line_no":8,"col_no":10}}'
            - '{"type":"identifier","value":"System","pos":{"byte_no":154,"line_no":8,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":155,"line_no":8,"col_no":17}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":156,"line_no":8,"col_no":18}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":157,"line_no":8,"col_no":19}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":161,"line_no":9,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":164,"line_no":9,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":165,"line_no":9,"col_no":8}}'
            - '{"type":"identifier","value":"Status","pos":{"byte_no":171,"line_no":9,"col_no":14}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":172,"line_no":9,"col_no":15}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":173,"line_no":9,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":174,"line_no":9,"col_no":17}}'
            - '{"type":"identifier","value":"Failure","pos":{"byte_no":181,"line_no":9,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":182,"line_no":9,"col_no":25}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":183,"line_no":10,"col_no":1}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":187,"line_no":11,"col_no":4}}'
            - '{"type":"keyword","value":"namespace","pos":{"byte_no":196,"line_no":11,"col_no":13}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":197,"line_no":11,"col_no":14}}'
            - '{"type":"identifier","value":"Auth","pos":{"byte_no":201,"line_no":11,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":202,"line_no":11,"col_no":19}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":203,"line_no":11,"col_no":20}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":204,"line_no":11,"col_no":21}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":212,"line_no":12,"col_no":8}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":216,"line_no":12,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":217,"line_no":12,"col_no":13}}'
            - '{"type":"identifier","value":"User","pos":{"byte_no":221,"line_no":12,"col_no":17}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":222,"line_no":12,"col_no":18}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":223,"line_no":12,"col_no":19}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":224,"line_no":12,"col_no":20}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":236,"line_no":13,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":242,"line_no":13,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":243,"line_no":13,"col_no":19}}'
            - '{"type":"identifier","value":"username","pos":{"byte_no":251,"line_no":13,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":252,"line_no":13,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":264,"line_no":14,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":270,"line_no":14,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":271,"line_no":14,"col_no":19}}'
            - '{"type":"identifier","value":"email","pos":{"byte_no":276,"line_no":14,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":277,"line_no":14,"col_no":25}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":289,"line_no":15,"col_no":12}}'
            - '{"type":"keyword","value":"map","pos":{"byte_no":292,"line_no":15,"col_no":15}}'
            - '{"type":"type-arg-list-start","value":"\u003c","pos":{"byte_no":293,"line_no":15,"col_no":16}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":299,"line_no":15,"col_no":22}}'
            - '{"type":"arg-list-sep","value":",","pos":{"byte_no":300,"line_no":15,"col_no":23}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":301,"line_no":15,"col_no":24}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":307,"line_no":15,"col_no":30}}'
            - '{"type":"type-arg-list-end","value":"\u003e","pos":{"byte_no":308,"line_no":15,"col_no":31}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":309,"line_no":15,"col_no":32}}'
            - '{"type":"identifier","value":"metadata","pos":{"byte_no":317,"line_no":15,"col_no":40}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":318,"line_no":15,"col_no":41}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":326,"line_no":16,"col_no":8}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":327,"line_no":16,"col_no":9}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":328,"line_no":16,"col_no":10}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":329,"line_no":17,"col_no":1}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":337,"line_no":18,"col_no":8}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":341,"line_no":18,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":342,"line_no":18,"col_no":13}}'
            - '{"type":"identifier","value":"AuthRequest","pos":{"byte_no":353,"line_no":18,"col_no":24}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":354,"line_no":18,"col_no":25}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":355,"line_no":18,"col_no":26}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":356,"line_no":18,"col_no":27}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":368,"line_no":19,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":374,"line_no":19,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":375,"line_no":19,"col_no":19}}'
            - '{"type":"identifier","value":"provider","pos":{"byte_no":383,"line_no":19,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":384,"line_no":19,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":396,"line_no":20,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":402,"line_no":20,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":403,"line_no":20,"col_no":19}}'
            - '{"type":"identifier","value":"username","pos":{"byte_no":411,"line_no":20,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":412,"line_no":20,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":424,"line_no":21,"col_no":12}}'
            - '{"type":"keyword","value":"data","pos":{"byte_no":428,"line_no":21,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":429,"line_no":21,"col_no":17}}'
            - '{"type":"identifier","value":"authData","pos":{"byte_no":437,"line_no":21,"col_no":25}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":438,"line_no":21,"col_no":26}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":446,"line_no":22,"col_no":8}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":447,"line_no":22,"col_no":9}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":448,"line_no":22,"col_no":10}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":449,"line_no":23,"col_no":1}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":457,"line_no":24,"col_no":8}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":461,"line_no":24,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":462,"line_no":24,"col_no":13}}'
            - '{"type":"identifier","value":"AuthResponse","pos":{"byte_no":474,"line_no":24,"col_no":25}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":475,"line_no":24,"col_no":26}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":476,"line_no":24,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":477,"line_no":24,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":489,"line_no":25,"col_no":12}}'
            - '{"type":"identifier","value":"Failure","pos":{"byte_no":496,"line_no":25,"col_no":19}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":497,"line_no":25,"col_no":20}}'
            - '{"type":"identifier","value":"failure","pos":{"byte_no":504,"line_no":25,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":505,"line_no":25,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":517,"line_no":26,"col_no":12}}'
            - '{"type":"identifier","value":"User","pos":{"byte_no":521,"line_no":26,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":522,"line_no":26,"col_no":17}}'
            - '{"type":"identifier","value":"user","pos":{"byte_no":526,"line_no":26,"col_no":21}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":527,"line_no":26,"col_no":22}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":535,"line_no":27,"col_no":8}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":536,"line_no":27,"col_no":9}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":537,"line_no":27,"col_no":10}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":541,"line_no":28,"col_no":4}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":542,"line_no":28,"col_no":5}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":543,"line_no":28,"col_no":6}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":544,"line_no":29,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":545,"line_no":29,"col_no":2}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":546,"line_no":30,"col_no":1}}'
            - '{"type":"keyword","value":"namespace","pos":{"byte_no":555,"line_no":31,"col_no":9}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":556,"line_no":31,"col_no":10}}'
            - '{"type":"identifier","value":"Todos","pos":{"byte_no":561,"line_no":31,"col_no":15}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":562,"line_no":31,"col_no":16}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":563,"line_no":31,"col_no":17}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":564,"line_no":31,"col_no":18}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":568,"line_no":32,"col_no":4}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":572,"line_no":32,"col_no":8}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":573,"line_no":32,"col_no":9}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":577,"line_no":32,"col_no":13}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":578,"line_no":32,"col_no":14}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":579,"line_no":32,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":580,"line_no":32,"col_no":16}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":588,"line_no":33,"col_no":8}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":594,"line_no":33,"col_no":14}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":595,"line_no":33,"col_no":15}}'
            - '{"type":"identifier","value":"id","pos":{"byte_no":597,"line_no":33,"col_no":17}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":598,"line_no":33,"col_no":18}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":606,"line_no":34,"col_no":8}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":612,"line_no":34,"col_no":14}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":613,"line_no":34,"col_no":15}}'
            - '{"type":"identifier","value":"description","pos":{"byte_no":624,"line_no":34,"col_no":26}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":625,"line_no":34,"col_no":27}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":633,"line_no":35,"col_no":8}}'
            - '{"type":"keyword","value":"time","pos":{"byte_no":637,"line_no":35,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":638,"line_no":35,"col_no":13}}'
            - '{"type":"identifier","value":"ctime","pos":{"byte_no":643,"line_no":35,"col_no":18}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":644,"line_no":35,"col_no":19}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":652,"line_no":36,"col_no":8}}'
            - '{"type":"keyword","value":"bool","pos":{"byte_no":656,"line_no":36,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":657,"line_no":36,"col_no":13}}'
            - '{"type":"identifier","value":"completed","pos":{"byte_no":666,"line_no":36,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":667,"line_no":36,"col_no":23}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":668,"line_no":37,"col_no":1}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":676,"line_no":38,"col_no":8}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":682,"line_no":38,"col_no":14}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":683,"line_no":38,"col_no":15}}'
            - '{"type":"identifier","value":"author","pos":{"byte_no":689,"line_no":38,"col_no":21}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":690,"line_no":38,"col_no":22}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":698,"line_no":39,"col_no":8}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":704,"line_no":39,"col_no":14}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":705,"line_no":39,"col_no":15}}'
            - '{"type":"identifier","value":"assignee","pos":{"byte_no":713,"line_no":39,"col_no":23}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":714,"line_no":39,"col_no":24}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":722,"line_no":40,"col_no":8}}'
            - '{"type":"keyword","value":"time","pos":{"byte_no":726,"line_no":40,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":727,"line_no":40,"col_no":13}}'
            - '{"type":"identifier","value":"dueDate","pos":{"byte_no":734,"line_no":40,"col_no":20}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":735,"line_no":40,"col_no":21}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":743,"line_no":41,"col_no":8}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":749,"line_no":41,"col_no":14}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":750,"line_no":41,"col_no":15}}'
            - '{"type":"identifier","value":"category","pos":{"byte_no":758,"line_no":41,"col_no":23}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":759,"line_no":41,"col_no":24}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":767,"line_no":42,"col_no":8}}'
            - '{"type":"keyword","value":"list","pos":{"byte_no":771,"line_no":42,"col_no":12}}'
            - '{"type":"type-arg-list-start","value":"\u003c","pos":{"byte_no":772,"line_no":42,"col_no":13}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":778,"line_no":42,"col_no":19}}'
            - '{"type":"type-arg-list-end","value":"\u003e","pos":{"byte_no":779,"line_no":42,"col_no":20}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":780,"line_no":42,"col_no":21}}'
            - '{"type":"identifier","value":"tags","pos":{"byte_no":784,"line_no":42,"col_no":25}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":785,"line_no":42,"col_no":26}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":789,"line_no":43,"col_no":4}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":790,"line_no":43,"col_no":5}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":791,"line_no":43,"col_no":6}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":792,"line_no":44,"col_no":1}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":796,"line_no":45,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":799,"line_no":45,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":800,"line_no":45,"col_no":8}}'
            - '{"type":"identifier","value":"List","pos":{"byte_no":804,"line_no":45,"col_no":12}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":805,"line_no":45,"col_no":13}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":806,"line_no":45,"col_no":14}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":807,"line_no":45,"col_no":15}}'
            - '{"type":"keyword","value":"list","pos":{"byte_no":811,"line_no":45,"col_no":19}}'
            - '{"type":"type-arg-list-start","value":"\u003c","pos":{"byte_no":812,"line_no":45,"col_no":20}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":816,"line_no":45,"col_no":24}}'
            - '{"type":"type-arg-list-end","value":"\u003e","pos":{"byte_no":817,"line_no":45,"col_no":25}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":818,"line_no":45,"col_no":26}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":822,"line_no":46,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":825,"line_no":46,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":826,"line_no":46,"col_no":8}}'
            - '{"type":"identifier","value":"Get","pos":{"byte_no":829,"line_no":46,"col_no":11}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":830,"line_no":46,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":836,"line_no":46,"col_no":18}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":837,"line_no":46,"col_no":19}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":838,"line_no":46,"col_no":20}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":842,"line_no":46,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":843,"line_no":46,"col_no":25}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":847,"line_no":47,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":850,"line_no":47,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":851,"line_no":47,"col_no":8}}'
            - '{"type":"identifier","value":"Put","pos":{"byte_no":854,"line_no":47,"col_no":11}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":855,"line_no":47,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":861,"line_no":47,"col_no":18}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":862,"line_no":47,"col_no":19}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":863,"line_no":47,"col_no":20}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":867,"line_no":47,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":868,"line_no":47,"col_no":25}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":872,"line_no":48,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":875,"line_no":48,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":876,"line_no":48,"col_no":8}}'
            - '{"type":"identifier","value":"Delete","pos":{"byte_no":882,"line_no":48,"col_no":14}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":883,"line_no":48,"col_no":15}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":889,"line_no":48,"col_no":21}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":890,"line_no":48,"col_no":22}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":891,"line_no":48,"col_no":23}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":895,"line_no":48,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":896,"line_no":48,"col_no":28}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":897,"line_no":49,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":898,"line_no":49,"col_no":2}}'
            - '{"type":"end-of-file","value":"","pos":{"byte_no":898,"line_no":50,"col_no":0}}'
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Basics \ Parse
  commands:
    - command: $(go env GOPATH)/bin/rpc -parse todo-simple.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - '{'
            - '  "name": "root",'
            - '  "children": null,'
            - '  "options": {'
            - '    "encoding": "json",'
            - '    "go_package": "minitodo",'
            - '    "ruby_module": "minitodo",'
            - '    "transport": "http"'
            - '  },'
            - '  "types": {'
            - '    "Failure": {'
            - '      "name": "Failure",'
            - '      "properties": {'
            - '        "code": {'
            - '          "name": "code",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "description": {'
            - '          "name": "description",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        }'
            - '      }'
            - '    },'
            - '    "TodoItem": {'
            - '      "name": "TodoItem",'
            - '      "properties": {'
            - '        "completed": {'
            - '          "name": "completed",'
            - '          "type": {'
            - '            "name": "bool",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "ctime": {'
            - '          "name": "ctime",'
            - '          "type": {'
            - '            "name": "time",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "description": {'
            - '          "name": "description",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "metadata": {'
            - '          "name": "metadata",'
            - '          "type": {'
            - '            "name": "data",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "uuid": {'
            - '          "name": "uuid",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        }'
            - '      }'
            - '    }'
            - '  },'
            - '  "rpcs": {'
            - '    "Delete": {'
            - '      "name": "Delete",'
            - '      "input": ['
            - '        {'
            - '          "name": "string",'
            - '          "arguments": null'
            - '        }'
            - '      ],'
            - '      "output": ['
            - '        {'
            - '          "name": "TodoItem",'
            - '          "arguments": null'
            - '        }'
            - '      ]'
            - '    },'
            - '    "Get": {'
            - '      "name": "Get",'
            - '      "input": ['
            - '        {'
            - '          "name": "string",'
            - '          "arguments": null'
            - '        }'
            - '      ],'
            - '      "output": ['
            - '        {'
            - '          "name": "TodoItem",'
            - '          "arguments": null'
            - '        }'
            - '      ]'
            - '    },'
            - '    "List": {'
            - '      "name": "List",'
            - '      "input": null,'
            - '      "output": ['
            - '        {'
            - '          "name": "list",'
            - '          "arguments": ['
            - '            {'
            - '              "name": "TodoItem",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        }'
            - '      ]'
            - '    },'
            - '    "Put": {'
            - '      "name": "Put",'
            - '      "input": ['
            - '        {'
            - '          "name": "TodoItem",'
            - '          "arguments": null'
            - '        }'
            - '      ],'
            - '      "output": ['
            - '        {'
            - '          "name": "TodoItem",'
            - '          "arguments": null'
            - '        }'
            - '      ]'
            - '    }'
            - '  }'
            - '}'
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -parse todo-complex.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - '{'
            - '  "name": "root",'
            - '  "children": {'
            - '    "System": {'
            - '      "name": "System",'
            - '      "children": {'
            - '        "Auth": {'
            - '          "name": "Auth",'
            - '          "children": null,'
            - '          "options": null,'
            - '          "types": {'
            - '            "AuthRequest": {'
            - '              "name": "AuthRequest",'
            - '              "properties": {'
            - '                "authData": {'
            - '                  "name": "authData",'
            - '                  "type": {'
            - '                    "name": "data",'
            - '                    "arguments": null'
            - '                  }'
            - '                },'
            - '                "provider": {'
            - '                  "name": "provider",'
            - '                  "type": {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                },'
            - '                "username": {'
            - '                  "name": "username",'
            - '                  "type": {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                }'
            - '              }'
            - '            },'
            - '            "AuthResponse": {'
            - '              "name": "AuthResponse",'
            - '              "properties": {'
            - '                "failure": {'
            - '                  "name": "failure",'
            - '                  "type": {'
            - '                    "name": "Failure",'
            - '                    "arguments": null'
            - '                  }'
            - '                },'
            - '                "user": {'
            - '                  "name": "user",'
            - '                  "type": {'
            - '                    "name": "User",'
            - '                    "arguments": null'
            - '                  }'
            - '                }'
            - '              }'
            - '            },'
            - '            "User": {'
            - '              "name": "User",'
            - '              "properties": {'
            - '                "email": {'
            - '                  "name": "email",'
            - '                  "type": {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                },'
            - '                "metadata": {'
            - '                  "name": "metadata",'
            - '                  "type": {'
            - '                    "name": "map",'
            - '                    "arguments": ['
            - '                      {'
            - '                        "name": "string",'
            - '                        "arguments": null'
            - '                      },'
            - '                      {'
            - '                        "name": "string",'
            - '                        "arguments": null'
            - '                      }'
            - '                    ]'
            - '                  }'
            - '                },'
            - '                "username": {'
            - '                  "name": "username",'
            - '                  "type": {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                }'
            - '              }'
            - '            }'
            - '          },'
            - '          "rpcs": null'
            - '        }'
            - '      },'
            - '      "options": null,'
            - '      "types": null,'
            - '      "rpcs": {'
            - '        "Status": {'
            - '          "name": "Status",'
            - '          "input": null,'
            - '          "output": ['
            - '            {'
            - '              "name": "Failure",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        }'
            - '      }'
            - '    },'
            - '    "Todos": {'
            - '      "name": "Todos",'
            - '      "children": null,'
            - '      "options": null,'
            - '      "types": {'
            - '        "Item": {'
            - '          "name": "Item",'
            - '          "properties": {'
            - '            "assignee": {'
            - '              "name": "assignee",'
            - '              "type": {'
            - '                "name": "string",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "author": {'
            - '              "name": "author",'
            - '              "type": {'
            - '                "name": "string",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "category": {'
            - '              "name": "category",'
            - '              "type": {'
            - '                "name": "string",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "completed": {'
            - '              "name": "completed",'
            - '              "type": {'
            - '                "name": "bool",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "ctime": {'
            - '              "name": "ctime",'
            - '              "type": {'
            - '                "name": "time",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "description": {'
            - '              "name": "description",'
            - '              "type": {'
            - '                "name": "string",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "dueDate": {'
            - '              "name": "dueDate",'
            - '              "type": {'
            - '                "name": "time",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "id": {'
            - '              "name": "id",'
            - '              "type": {'
            - '                "name": "string",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "tags": {'
            - '              "name": "tags",'
            - '              "type": {'
            - '                "name": "list",'
            - '                "arguments": ['
            - '                  {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                ]'
            - '              }'
            - '            }'
            - '          }'
            - '        }'
            - '      },'
            - '      "rpcs": {'
            - '        "Delete": {'
            - '          "name": "Delete",'
            - '          "input": ['
            - '            {'
            - '              "name": "string",'
            - '              "arguments": null'
            - '            }'
            - '          ],'
            - '          "output": ['
            - '            {'
            - '              "name": "Item",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        },'
            - '        "Get": {'
            - '          "name": "Get",'
            - '          "input": ['
            - '            {'
            - '              "name": "string",'
            - '              "arguments": null'
            - '            }'
            - '          ],'
            - '          "output": ['
            - '            {'
            - '              "name": "Item",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        },'
            - '        "List": {'
            - '          "name": "List",'
            - '          "input": null,'
            - '          "output": ['
            - '            {'
            - '              "name": "list",'
            - '              "arguments": ['
            - '                {'
            - '                  "name": "Item",'
            - '                  "arguments": null'
            - '                }'
            - '              ]'
            - '            }'
            - '          ]'
            - '        },'
            - '        "Put": {'
            - '          "name": "Put",'
            - '          "input": ['
            - '            {'
            - '              "name": "string",'
            - '              "arguments": null'
            - '            }'
            - '          ],'
            - '          "output": ['
            - '            {'
            - '              "name": "Item",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        }'
            - '      }'
            - '    }'
            - '  },'
            - '  "options": {'
            - '    "go_import": "github.com/chakrit/rpc/examples",'
            - '    "go_package": "examples"'
            - '  },'
            - '  "types": {'
            - '    "Failure": {'
            - '      "name": "Failure",'
            - '      "properties": {'
            - '        "code": {'
            - '          "name": "code",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "description": {'
            - '          "name": "description",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        }'
            - '      }'
            - '    }'
            - '  },'
            - '  "rpcs": null'
            - '}'
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Generators
  commands:
    - command: rm -r /tmp/rpc >/dev/null 2>&1 || true
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Generators \ Elm
  commands:
    - command: rm -r /tmp/rpc >/dev/null 2>&1 || true
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Generators \ Elm \ Simple
  commands:
    - command: rm -r /tmp/rpc >/dev/null 2>&1 || true
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -gen elm -out /tmp/rpc/elm todo-simple.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/elm -name "*.elm"
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - /tmp/rpc/elm/Rpc.elm
            - /tmp/rpc/elm/RpcUtil.elm
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/elm -name "*.elm" | xargs cat
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - module Rpc exposing (..)
            - ""
            - import Http
            - import Json.Decode as D
            - import Json.Encode as E
            - import Dict exposing (Dict)
            - import Time exposing (Posix)
            - import Bytes exposing (Bytes)
            - import Bytes.Encode
            - import RpcUtil exposing (Config, CallResult, unwrapHttpResult, decodeCallResult,
              decodeApply)
            - ""
            - ""
            - ""
            - type alias Failure =
            - '    { code : String'
            - '    , description : String'
            - '    }'
            - ""
            - 'defaultFailure : Failure'
            - defaultFailure =
            - '    { code = ""'
            - '    , description = ""'
            - '    }'
            - ""
            - 'encodeFailure : Failure -> E.Value'
            - encodeFailure obj =
            - '    E.object'
            - '        [ ( "code", E.string obj.code )'
            - '        , ( "description", E.string obj.description )'
            - '        ]'
            - ""
            - 'decodeFailure : D.Decoder Failure'
            - decodeFailure =
            - '    D.map2 Failure'
            - '                (D.string'
            - '                    |> D.field "code"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '                (D.string'
            - '                    |> D.field "description"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '    '
            - ""
            - type alias TodoItem =
            - '    { completed : Bool'
            - '    , ctime : Posix'
            - '    , description : String'
            - '    , metadata : Bytes'
            - '    , uuid : String'
            - '    }'
            - ""
            - 'defaultTodoItem : TodoItem'
            - defaultTodoItem =
            - '    { completed = False'
            - '    , ctime = Time.millisToPosix 0'
            - '    , description = ""'
            - '    , metadata = RpcUtil.emptyBytes'
            - '    , uuid = ""'
            - '    }'
            - ""
            - 'encodeTodoItem : TodoItem -> E.Value'
            - encodeTodoItem obj =
            - '    E.object'
            - '        [ ( "completed", E.bool obj.completed )'
            - '        , ( "ctime", (Time.posixToMillis >> toFloat >> (\f -> f/1000.0)
              >> E.float) obj.ctime )'
            - '        , ( "description", E.string obj.description )'
            - '        , ( "metadata", (RpcUtil.b64StringFromBytes >> Maybe.withDefault
              "" >> E.string) obj.metadata )'
            - '        , ( "uuid", E.string obj.uuid )'
            - '        ]'
            - ""
            - 'decodeTodoItem : D.Decoder TodoItem'
            - decodeTodoItem =
            - '    D.map5 TodoItem'
            - '                (D.bool'
            - '                    |> D.field "completed"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (False))'
            - '                )'
            - '                ((D.map ((\f -> f * 1000.0) >> round >> Time.millisToPosix)
              D.float)'
            - '                    |> D.field "ctime"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (Time.millisToPosix
              0))'
            - '                )'
            - '                (D.string'
            - '                    |> D.field "description"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '                ((D.map (Maybe.withDefault "" >> RpcUtil.b64StringToBytes
              >> Maybe.withDefault (Bytes.Encode.encode (Bytes.Encode.string "")))
              (D.maybe D.string))'
            - '                    |> D.field "metadata"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (RpcUtil.emptyBytes))'
            - '                )'
            - '                (D.string'
            - '                    |> D.field "uuid"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '    '
            - ""
            - ""
            - ""
            - type alias InputForDelete =
            - '    (String)'
            - ""
            - 'encodeInputForDelete : InputForDelete -> E.Value'
            - encodeInputForDelete
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ E.string arg0'
            - '            ]'
            - ""
            - 'decodeInputForDelete : D.Decoder InputForDelete'
            - decodeInputForDelete =
            - '        D.string'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (""))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias OutputForDelete =
            - '    (TodoItem)'
            - ""
            - 'encodeOutputForDelete : OutputForDelete -> E.Value'
            - encodeOutputForDelete
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ encodeTodoItem arg0'
            - '            ]'
            - ""
            - 'decodeOutputForDelete : D.Decoder OutputForDelete'
            - decodeOutputForDelete =
            - '        decodeTodoItem'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (defaultTodoItem))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias InputForGet =
            - '    (String)'
            - ""
            - 'encodeInputForGet : InputForGet -> E.Value'
            - encodeInputForGet
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ E.string arg0'
            - '            ]'
            - ""
            - 'decodeInputForGet : D.Decoder InputForGet'
            - decodeInputForGet =
            - '        D.string'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (""))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias OutputForGet =
            - '    (TodoItem)'
            - ""
            - 'encodeOutputForGet : OutputForGet -> E.Value'
            - encodeOutputForGet
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ encodeTodoItem arg0'
            - '            ]'
            - ""
            - 'decodeOutputForGet : D.Decoder OutputForGet'
            - decodeOutputForGet =
            - '        decodeTodoItem'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (defaultTodoItem))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias InputForList =
            - '    (())'
            - ""
            - 'encodeInputForList : InputForList -> E.Value'
            - encodeInputForList
            - '    () ='
            - '        E.list (identity)'
            - '            ['
            - '            ]'
            - ""
            - 'decodeInputForList : D.Decoder InputForList'
            - decodeInputForList =
            - '        D.succeed ()'
            - ""
            - type alias OutputForList =
            - '    (List (TodoItem))'
            - ""
            - 'encodeOutputForList : OutputForList -> E.Value'
            - encodeOutputForList
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ E.list (encodeTodoItem) arg0'
            - '            ]'
            - ""
            - 'decodeOutputForList : D.Decoder OutputForList'
            - decodeOutputForList =
            - '        D.list (decodeTodoItem)'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault ([]))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias InputForPut =
            - '    (TodoItem)'
            - ""
            - 'encodeInputForPut : InputForPut -> E.Value'
            - encodeInputForPut
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ encodeTodoItem arg0'
            - '            ]'
            - ""
            - 'decodeInputForPut : D.Decoder InputForPut'
            - decodeInputForPut =
            - '        decodeTodoItem'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (defaultTodoItem))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias OutputForPut =
            - '    (TodoItem)'
            - ""
            - 'encodeOutputForPut : OutputForPut -> E.Value'
            - encodeOutputForPut
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ encodeTodoItem arg0'
            - '            ]'
            - ""
            - 'decodeOutputForPut : D.Decoder OutputForPut'
            - decodeOutputForPut =
            - '        decodeTodoItem'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (defaultTodoItem))'
            - '            |> D.map (\a -> (a))'
            - ""
            - ""
            - ""
            - 'callDelete : Config -> InputForDelete -> (CallResult OutputForDelete
              -> a) -> Cmd a'
            - callDelete config input mapResult =
            - '    let'
            - '        body = Http.jsonBody (encodeInputForDelete input)'
            - '        expect = Http.expectJson (unwrapHttpResult >> mapResult) (decodeCallResult
              decodeOutputForDelete)'
            - '    in'
            - '    Http.request'
            - '        { method = "POST"'
            - '        , headers = config.headers'
            - '        , url = config.baseUrl ++ "/rpc/Delete"'
            - '        , body = body'
            - '        , expect = expect'
            - '        , timeout = Nothing'
            - '        , tracker = Nothing'
            - '        }'
            - ""
            - 'callGet : Config -> InputForGet -> (CallResult OutputForGet -> a) ->
              Cmd a'
            - callGet config input mapResult =
            - '    let'
            - '        body = Http.jsonBody (encodeInputForGet input)'
            - '        expect = Http.expectJson (unwrapHttpResult >> mapResult) (decodeCallResult
              decodeOutputForGet)'
            - '    in'
            - '    Http.request'
            - '        { method = "POST"'
            - '        , headers = config.headers'
            - '        , url = config.baseUrl ++ "/rpc/Get"'
            - '        , body = body'
            - '        , expect = expect'
            - '        , timeout = Nothing'
            - '        , tracker = Nothing'
            - '        }'
            - ""
            - 'callList : Config -> InputForList -> (CallResult OutputForList -> a)
              -> Cmd a'
            - callList config input mapResult =
            - '    let'
            - '        body = Http.jsonBody (encodeInputForList input)'
            - '        expect = Http.expectJson (unwrapHttpResult >> mapResult) (decodeCallResult
              decodeOutputForList)'
            - '    in'
            - '    Http.request'
            - '        { method = "POST"'
            - '        , headers = config.headers'
            - '        , url = config.baseUrl ++ "/rpc/List"'
            - '        , body = body'
            - '        , expect = expect'
            - '        , timeout = Nothing'
            - '        , tracker = Nothing'
            - '        }'
            - ""
            - 'callPut : Config -> InputForPut -> (CallResult OutputForPut -> a) ->
              Cmd a'
            - callPut config input mapResult =
            - '    let'
            - '        body = Http.jsonBody (encodeInputForPut input)'
            - '        expect = Http.expectJson (unwrapHttpResult >> mapResult) (decodeCallResult
              decodeOutputForPut)'
            - '    in'
            - '    Http.request'
            - '        { method = "POST"'
            - '        , headers = config.headers'
            - '        , url = config.baseUrl ++ "/rpc/Put"'
            - '        , body = body'
            - '        , expect = expect'
            - '        , timeout = Nothing'
            - '        , tracker = Nothing'
            - '        }'
            - ""
            - module RpcUtil exposing
            - '    ( CallResult(..)'
            - '    , Config'
            - '    , b64StringFromBytes'
            - '    , b64StringToBytes'
            - '    , decodeApply'
            - '    , decodeCallResult'
            - '    , decodeConfig'
            - '    , emptyBytes'
            - '    , mapResult'
            - '    , translateHttpError'
            - '    , unwrapHttpResult'
            - '    )'
            - ""
            - import Array exposing (Array)
            - import Bitwise as Bits
            - import Bytes exposing (Bytes)
            - import Bytes.Decode as BytesDec
            - import Bytes.Encode as BytesEnc
            - import Dict exposing (Dict)
            - import Http exposing (Error(..))
            - import Json.Decode as JsonDec
            - ""
            - ""
            - type alias Config =
            - '    { baseUrl : String'
            - '    , headers : List Http.Header'
            - '    }'
            - ""
            - ""
            - 'decodeConfig : JsonDec.Decoder Config'
            - decodeConfig =
            - '    let'
            - '        mapHeader : Array String -> Http.Header'
            - '        mapHeader arr ='
            - '            let'
            - '                header ='
            - '                    Array.get 0 arr |> Maybe.withDefault ""'
            - ""
            - '                content ='
            - '                    Array.get 1 arr |> Maybe.withDefault ""'
            - '            in'
            - '            Http.header header content'
            - ""
            - '        mapHeaderArray : Array (Array String) -> List Http.Header'
            - '        mapHeaderArray arr ='
            - '            arr |> Array.map mapHeader |> Array.toList'
            - '    in'
            - '    JsonDec.map2 Config'
            - '        (JsonDec.field "baseUrl" <| JsonDec.string)'
            - '        (JsonDec.field "headers" <| JsonDec.map mapHeaderArray (JsonDec.array
              (JsonDec.array JsonDec.string)))'
            - ""
            - ""
            - 'decodeApply : JsonDec.Decoder a -> JsonDec.Decoder (a -> b) -> JsonDec.Decoder
              b'
            - decodeApply fieldDec partial =
            - '    JsonDec.andThen (\p -> JsonDec.map p fieldDec) partial'
            - ""
            - ""
            - type CallResult a
            - '    = HttpError Http.Error'
            - '    | ApiError String'
            - '    | Success a'
            - ""
            - ""
            - 'translateHttpError : Http.Error -> String'
            - translateHttpError httpErr =
            - '    case httpErr of'
            - '        BadUrl str ->'
            - '            "Bad URL: " ++ str'
            - ""
            - '        Timeout ->'
            - '            "Network Timeout"'
            - ""
            - '        NetworkError ->'
            - '            "Network Error"'
            - ""
            - '        BadStatus code ->'
            - '            "Bad Status Code: " ++ String.fromInt code'
            - ""
            - '        BadBody str ->'
            - '            "Malformed Response: " ++ str'
            - ""
            - ""
            - 'mapResult : { onHttpErr : Http.Error -> msg, onApiErr : String -> msg,
              onSuccess : a -> msg } -> CallResult a -> msg'
            - mapResult mapper result =
            - '    case result of'
            - '        HttpError httpErr ->'
            - '            mapper.onHttpErr httpErr'
            - ""
            - '        ApiError err ->'
            - '            mapper.onApiErr err'
            - ""
            - '        Success obj ->'
            - '            mapper.onSuccess obj'
            - ""
            - ""
            - 'unwrapHttpResult : Result Http.Error (CallResult a) -> CallResult a'
            - unwrapHttpResult result =
            - '    case result of'
            - '        Ok callResult ->'
            - '            callResult'
            - ""
            - '        Err httpErr ->'
            - '            HttpError httpErr'
            - ""
            - ""
            - 'decodeCallResult : JsonDec.Decoder a -> JsonDec.Decoder (CallResult
              a)'
            - decodeCallResult decodeReturns =
            - '    let'
            - '        mapResultObj : Maybe String -> a -> CallResult a'
            - '        mapResultObj err ret ='
            - '            case err of'
            - '                Just str ->'
            - '                    ApiError str'
            - ""
            - '                Nothing ->'
            - '                    Success ret'
            - '    in'
            - '    JsonDec.map2 mapResultObj'
            - '        (JsonDec.field "error" (JsonDec.maybe JsonDec.string))'
            - '        (JsonDec.field "returns" decodeReturns)'
            - ""
            - ""
            - 'emptyBytes : Bytes'
            - emptyBytes =
            - '    BytesEnc.encode (BytesEnc.sequence [])'
            - ""
            - ""
            - 'stringToBytes : String -> Bytes'
            - stringToBytes str =
            - '    BytesEnc.encode (BytesEnc.string str)'
            - ""
            - ""
            - 'stringFromBytes : Bytes -> Maybe String'
            - stringFromBytes bytes =
            - '    BytesDec.decode (BytesDec.string (Bytes.width bytes)) bytes'
            - ""
            - ""
            - 'b64StringToBytes : String -> Maybe Bytes'
            - b64StringToBytes str =
            - '    decodeB64Chars (String.toList str)'
            - '        |> Maybe.map (BytesEnc.sequence >> BytesEnc.encode)'
            - ""
            - ""
            - 'decodeB64Chars : List Char -> Maybe (List BytesEnc.Encoder)'
            - decodeB64Chars l =
            - '    case l of'
            - '        [] ->'
            - '            Just []'
            - ""
            - '        a :: b :: ''='' :: ''='' :: [] ->'
            - '            b64Dec2 a b |> Maybe.map List.singleton'
            - ""
            - '        a :: b :: [] ->'
            - '            b64Dec2 a b |> Maybe.map List.singleton'
            - ""
            - '        a :: b :: c :: ''='' :: [] ->'
            - '            b64Dec3 a b c |> Maybe.map List.singleton'
            - ""
            - '        a :: b :: c :: [] ->'
            - '            b64Dec3 a b c |> Maybe.map List.singleton'
            - ""
            - '        a :: b :: c :: d :: tail ->'
            - '            case ( b64Dec4 a b c d, decodeB64Chars tail ) of'
            - '                ( Just e, Just list ) ->'
            - '                    Just <| e :: list'
            - ""
            - '                _ ->'
            - '                    Nothing'
            - ""
            - '        _ ->'
            - '            Nothing'
            - ""
            - ""
            - 'b64StringFromBytes : Bytes -> Maybe String'
            - b64StringFromBytes bytes =
            - '    let'
            - '        get3 ='
            - '            BytesDec.map3 b64Enc3 BytesDec.unsignedInt8 BytesDec.unsignedInt8
              BytesDec.unsignedInt8'
            - ""
            - '        get2 ='
            - '            BytesDec.map2 b64Enc2 BytesDec.unsignedInt8 BytesDec.unsignedInt8'
            - ""
            - '        get1 ='
            - '            BytesDec.map b64Enc1 BytesDec.unsignedInt8'
            - ""
            - '        process : B64State -> BytesDec.Decoder (BytesDec.Step B64State
              (List Char))'
            - '        process state ='
            - '            if state.processed >= state.total then'
            - '                BytesDec.succeed <| BytesDec.Done state.output'
            - ""
            - '            else'
            - '                BytesDec.map BytesDec.Loop <|'
            - '                    case state.total - state.processed of'
            - '                        1 ->'
            - '                            get1 |> BytesDec.map (appendB64State 1
              state)'
            - ""
            - '                        2 ->'
            - '                            get2 |> BytesDec.map (appendB64State 2
              state)'
            - ""
            - '                        _ ->'
            - '                            -- 3 or more'
            - '                            get3 |> BytesDec.map (appendB64State 3
              state)'
            - ""
            - '        decoder ='
            - '            BytesDec.loop (initialB64State bytes) process'
            - '                |> BytesDec.map String.fromList'
            - '    in'
            - '    BytesDec.decode decoder bytes'
            - ""
            - ""
            - '{-| base64 1111 1122 2222 3333 3344 4444'
            - '|||| bytes 1111 1111 2222 2222 3333 3333'
            - -}
            - 'b64Dec4 : Char -> Char -> Char -> Char -> Maybe BytesEnc.Encoder'
            - b64Dec4 a b c d =
            - '    case [ toB64byte a, toB64byte b, toB64byte c, toB64byte d ] of'
            - '        [ Just aa, Just bb, Just cc, Just dd ] ->'
            - '            Just <|'
            - '                BytesEnc.sequence'
            - '                    [ BytesEnc.unsignedInt8 ((aa |> Bits.shiftLeftBy
              2) + (bb |> Bits.shiftRightZfBy 4))'
            - '                    , BytesEnc.unsignedInt8 ((bb |> Bits.shiftLeftBy
              4) + (cc |> Bits.shiftRightZfBy 2))'
            - '                    , BytesEnc.unsignedInt8 ((cc |> Bits.shiftLeftBy
              6) + dd)'
            - '                    ]'
            - ""
            - '        _ ->'
            - '            Nothing'
            - ""
            - ""
            - '{-| base64 1111 1122 2222 3333 33'
            - '|||| bytes 1111 1111 2222 2222 ..'
            - -}
            - 'b64Dec3 : Char -> Char -> Char -> Maybe BytesEnc.Encoder'
            - b64Dec3 a b c =
            - '    case ( toB64byte a, toB64byte b, toB64byte c ) of'
            - '        ( Just aa, Just bb, Just cc ) ->'
            - '            Just <|'
            - '                BytesEnc.sequence'
            - '                    [ BytesEnc.unsignedInt8 ((aa |> Bits.shiftLeftBy
              2) + (bb |> Bits.shiftRightZfBy 4))'
            - '                    , BytesEnc.unsignedInt8 ((bb |> Bits.shiftLeftBy
              4) + (cc |> Bits.shiftRightZfBy 2))'
            - '                    ]'
            - ""
            - '        _ ->'
            - '            Nothing'
            - ""
            - ""
            - '{-| base64 1111 1122 2222 ....'
            - '|||| bytes 1111 1111 .... ....'
            - -}
            - 'b64Dec2 : Char -> Char -> Maybe BytesEnc.Encoder'
            - b64Dec2 a b =
            - '    case ( toB64byte a, toB64byte b ) of'
            - '        ( Just aa, Just bb ) ->'
            - '            Just <| BytesEnc.unsignedInt8 ((aa |> Bits.shiftLeftBy
              2) + (bb |> Bits.shiftRightZfBy 4))'
            - ""
            - '        _ ->'
            - '            Nothing'
            - ""
            - ""
            - '{-| bytes 1111 1111 2222 2222 3333 3333'
            - '|| base64 1111 1122 2222 3333 3344 4444'
            - -}
            - 'b64Enc3 : Int -> Int -> Int -> List Char'
            - b64Enc3 a b c =
            - '    [ Bits.shiftRightBy 2 a |> Bits.and 0x3F |> toB64char'
            - '    , (Bits.shiftLeftBy 4 a + Bits.shiftRightBy 4 b) |> Bits.and 0x3F
              |> toB64char'
            - '    , (Bits.shiftLeftBy 2 b + Bits.shiftRightBy 6 c) |> Bits.and 0x3F
              |> toB64char'
            - '    , c |> Bits.and 0x3F |> toB64char'
            - '    ]'
            - ""
            - ""
            - '{-| bytes 1111 1111 2222 2222 .... ....'
            - '|| base64 1111 1122 2222 3333 33.. ....'
            - -}
            - 'b64Enc2 : Int -> Int -> List Char'
            - b64Enc2 a b =
            - '    [ Bits.shiftRightBy 2 a |> Bits.and 0x3F |> toB64char'
            - '    , (Bits.shiftLeftBy 4 a + Bits.shiftRightBy 4 b) |> Bits.and 0x3F
              |> toB64char'
            - '    , Bits.shiftLeftBy 2 b |> Bits.and 0x3F |> toB64char'
            - '    , ''='''
            - '    ]'
            - ""
            - ""
            - '{-| bytes 1111 1111 .... ....'
            - '|| base64 1111 1122 2222 ....'
            - -}
            - 'b64Enc1 : Int -> List Char'
            - b64Enc1 a =
            - '    [ Bits.shiftRightBy 2 a |> Bits.and 0x3F |> toB64char'
            - '    , Bits.shiftLeftBy 4 a |> Bits.and 0x3F |> toB64char'
            - '    , ''='''
            - '    , ''='''
            - '    ]'
            - ""
            - ""
            - type alias B64State =
            - '    { total : Int'
            - '    , processed : Int'
            - '    , output : List Char'
            - '    }'
            - ""
            - ""
            - 'initialB64State : Bytes -> B64State'
            - initialB64State bytes =
            - '    { total = Bytes.width bytes'
            - '    , processed = 0'
            - '    , output = []'
            - '    }'
            - ""
            - ""
            - 'appendB64State : Int -> B64State -> List Char -> B64State'
            - appendB64State count state chars =
            - '    { state'
            - '        | processed = state.processed + count'
            - '        , output = List.append state.output chars'
            - '    }'
            - ""
            - ""
            - 'toB64byte : Char -> Maybe Int'
            - toB64byte c =
            - '    Dict.get c b64BackwardTable'
            - ""
            - ""
            - 'toB64char : Int -> Char'
            - toB64char n =
            - '    Dict.get n b64ForwardTable'
            - '        |> Maybe.withDefault ''?'''
            - ""
            - ""
            - 'b64BackwardTable : Dict Char Int'
            - b64BackwardTable =
            - '    Dict.fromList'
            - '        [ ( ''A'', 0 )'
            - '        , ( ''B'', 1 )'
            - '        , ( ''C'', 2 )'
            - '        , ( ''D'', 3 )'
            - '        , ( ''E'', 4 )'
            - '        , ( ''F'', 5 )'
            - '        , ( ''G'', 6 )'
            - '        , ( ''H'', 7 )'
            - '        , ( ''I'', 8 )'
            - '        , ( ''J'', 9 )'
            - '        , ( ''K'', 10 )'
            - '        , ( ''L'', 11 )'
            - '        , ( ''M'', 12 )'
            - '        , ( ''N'', 13 )'
            - '        , ( ''O'', 14 )'
            - '        , ( ''P'', 15 )'
            - '        , ( ''Q'', 16 )'
            - '        , ( ''R'', 17 )'
            - '        , ( ''S'', 18 )'
            - '        , ( ''T'', 19 )'
            - '        , ( ''U'', 20 )'
            - '        , ( ''V'', 21 )'
            - '        , ( ''W'', 22 )'
            - '        , ( ''X'', 23 )'
            - '        , ( ''Y'', 24 )'
            - '        , ( ''Z'', 25 )'
            - '        , ( ''a'', 26 )'
            - '        , ( ''b'', 27 )'
            - '        , ( ''c'', 28 )'
            - '        , ( ''d'', 29 )'
            - '        , ( ''e'', 30 )'
            - '        , ( ''f'', 31 )'
            - '        , ( ''g'', 32 )'
            - '        , ( ''h'', 33 )'
            - '        , ( ''i'', 34 )'
            - '        , ( ''j'', 35 )'
            - '        , ( ''k'', 36 )'
            - '        , ( ''l'', 37 )'
            - '        , ( ''m'', 38 )'
            - '        , ( ''n'', 39 )'
            - '        , ( ''o'', 40 )'
            - '        , ( ''p'', 41 )'
            - '        , ( ''q'', 42 )'
            - '        , ( ''r'', 43 )'
            - '        , ( ''s'', 44 )'
            - '        , ( ''t'', 45 )'
            - '        , ( ''u'', 46 )'
            - '        , ( ''v'', 47 )'
            - '        , ( ''w'', 48 )'
            - '        , ( ''x'', 49 )'
            - '        , ( ''y'', 50 )'
            - '        , ( ''z'', 51 )'
            - '        , ( ''0'', 52 )'
            - '        , ( ''1'', 53 )'
            - '        , ( ''2'', 54 )'
            - '        , ( ''3'', 55 )'
            - '        , ( ''4'', 56 )'
            - '        , ( ''5'', 57 )'
            - '        , ( ''6'', 58 )'
            - '        , ( ''7'', 59 )'
            - '        , ( ''8'', 60 )'
            - '        , ( ''9'', 61 )'
            - '        , ( ''-'', 62 )'
            - '        , ( ''_'', 63 )'
            - '        ]'
            - ""
            - ""
            - 'b64ForwardTable : Dict Int Char'
            - b64ForwardTable =
            - '    Dict.fromList'
            - '        [ ( 0, ''A'' )'
            - '        , ( 1, ''B'' )'
            - '        , ( 2, ''C'' )'
            - '        , ( 3, ''D'' )'
            - '        , ( 4, ''E'' )'
            - '        , ( 5, ''F'' )'
            - '        , ( 6, ''G'' )'
            - '        , ( 7, ''H'' )'
            - '        , ( 8, ''I'' )'
            - '        , ( 9, ''J'' )'
            - '        , ( 10, ''K'' )'
            - '        , ( 11, ''L'' )'
            - '        , ( 12, ''M'' )'
            - '        , ( 13, ''N'' )'
            - '        , ( 14, ''O'' )'
            - '        , ( 15, ''P'' )'
            - '        , ( 16, ''Q'' )'
            - '        , ( 17, ''R'' )'
            - '        , ( 18, ''S'' )'
            - '        , ( 19, ''T'' )'
            - '        , ( 20, ''U'' )'
            - '        , ( 21, ''V'' )'
            - '        , ( 22, ''W'' )'
            - '        , ( 23, ''X'' )'
            - '        , ( 24, ''Y'' )'
            - '        , ( 25, ''Z'' )'
            - '        , ( 26, ''a'' )'
            - '        , ( 27, ''b'' )'
            - '        , ( 28, ''c'' )'
            - '        , ( 29, ''d'' )'
            - '        , ( 30, ''e'' )'
            - '        , ( 31, ''f'' )'
            - '        , ( 32, ''g'' )'
            - '        , ( 33, ''h'' )'
            - '        , ( 34, ''i'' )'
            - '        , ( 35, ''j'' )'
            - '        , ( 36, ''k'' )'
            - '        , ( 37, ''l'' )'
            - '        , ( 38, ''m'' )'
            - '        , ( 39, ''n'' )'
            - '        , ( 40, ''o'' )'
            - '        , ( 41, ''p'' )'
            - '        , ( 42, ''q'' )'
            - '        , ( 43, ''r'' )'
            - '        , ( 44, ''s'' )'
            - '        , ( 45, ''t'' )'
            - '        , ( 46, ''u'' )'
            - '        , ( 47, ''v'' )'
            - '        , ( 48, ''w'' )'
            - '        , ( 49, ''x'' )'
            - '        , ( 50, ''y'' )'
            - '        , ( 51, ''z'' )'
            - '        , ( 52, ''0'' )'
            - '        , ( 53, ''1'' )'
            - '        , ( 54, ''2'' )'
            - '        , ( 55, ''3'' )'
            - '        , ( 56, ''4'' )'
            - '        , ( 57, ''5'' )'
            - '        , ( 58, ''6'' )'
            - '        , ( 59, ''7'' )'
            - '        , ( 60, ''8'' )'
            - '        , ( 61, ''9'' )'
            - '        , ( 62, ''-'' )'
            - '        , ( 63, ''_'' )'
            - '        ]'
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Generators \ Elm \ Complex
  commands:
    - command: rm -r /tmp/rpc >/dev/null 2>&1 || true
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -gen elm -out /tmp/rpc/elm todo-complex.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/elm -name "*.elm"
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - /tmp/rpc/elm/Rpc.elm
            - /tmp/rpc/elm/Rpc/Todos.elm
            - /tmp/rpc/elm/Rpc/System.elm
            - /tmp/rpc/elm/Rpc/System/Auth.elm
            - /tmp/rpc/elm/RpcUtil.elm
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/elm -name "*.elm" | xargs cat
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - module Rpc exposing (..)
            - ""
            - import Http
            - import Json.Decode as D
            - import Json.Encode as E
            - import Dict exposing (Dict)
            - import Time exposing (Posix)
            - import Bytes exposing (Bytes)
            - import Bytes.Encode
            - import RpcUtil exposing (Config, CallResult, unwrapHttpResult, decodeCallResult,
              decodeApply)
            - ""
            - ""
            - ""
            - type alias Failure =
            - '    { code : String'
            - '    , description : String'
            - '    }'
            - ""
            - 'defaultFailure : Failure'
            - defaultFailure =
            - '    { code = ""'
            - '    , description = ""'
            - '    }'
            - ""
            - 'encodeFailure : Failure -> E.Value'
            - encodeFailure obj =
            - '    E.object'
            - '        [ ( "code", E.string obj.code )'
            - '        , ( "description", E.string obj.description )'
            - '        ]'
            - ""
            - 'decodeFailure : D.Decoder Failure'
            - decodeFailure =
            - '    D.map2 Failure'
            - '                (D.string'
            - '                    |> D.field "code"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '                (D.string'
            - '                    |> D.field "description"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '    '
            - ""
            - ""
            - ""
            - ""
            - ""
            - module Rpc.Todos exposing (..)
            - ""
            - import Http
            - import Json.Decode as D
            - import Json.Encode as E
            - import Dict exposing (Dict)
            - import Time exposing (Posix)
            - import Bytes exposing (Bytes)
            - import Bytes.Encode
            - import RpcUtil exposing (Config, CallResult, unwrapHttpResult, decodeCallResult,
              decodeApply)
            - ""
            - ""
            - ""
            - type alias Item =
            - '    { assignee : String'
            - '    , author : String'
            - '    , category : String'
            - '    , completed : Bool'
            - '    , ctime : Posix'
            - '    , description : String'
            - '    , dueDate : Posix'
            - '    , id : String'
            - '    , tags : List (String)'
            - '    }'
            - ""
            - 'defaultItem : Item'
            - defaultItem =
            - '    { assignee = ""'
            - '    , author = ""'
            - '    , category = ""'
            - '    , completed = False'
            - '    , ctime = Time.millisToPosix 0'
            - '    , description = ""'
            - '    , dueDate = Time.millisToPosix 0'
            - '    , id = ""'
            - '    , tags = []'
            - '    }'
            - ""
            - 'encodeItem : Item -> E.Value'
            - encodeItem obj =
            - '    E.object'
            - '        [ ( "assignee", E.string obj.assignee )'
            - '        , ( "author", E.string obj.author )'
            - '        , ( "category", E.string obj.category )'
            - '        , ( "completed", E.bool obj.completed )'
            - '        , ( "ctime", (Time.posixToMillis >> toFloat >> (\f -> f/1000.0)
              >> E.float) obj.ctime )'
            - '        , ( "description", E.string obj.description )'
            - '        , ( "dueDate", (Time.posixToMillis >> toFloat >> (\f -> f/1000.0)
              >> E.float) obj.dueDate )'
            - '        , ( "id", E.string obj.id )'
            - '        , ( "tags", E.list (E.string) obj.tags )'
            - '        ]'
            - ""
            - 'decodeItem : D.Decoder Item'
            - decodeItem =
            - '    D.succeed Item'
            - '            |> (D.string'
            - '                |> D.field "assignee"'
            - '                |> D.maybe'
            - '                |> D.map (Maybe.withDefault (""))'
            - '                |> decodeApply)'
            - '            |> (D.string'
            - '                |> D.field "author"'
            - '                |> D.maybe'
            - '                |> D.map (Maybe.withDefault (""))'
            - '                |> decodeApply)'
            - '            |> (D.string'
            - '                |> D.field "category"'
            - '                |> D.maybe'
            - '                |> D.map (Maybe.withDefault (""))'
            - '                |> decodeApply)'
            - '            |> (D.bool'
            - '                |> D.field "completed"'
            - '                |> D.maybe'
            - '                |> D.map (Maybe.withDefault (False))'
            - '                |> decodeApply)'
            - '            |> ((D.map ((\f -> f * 1000.0) >> round >> Time.millisToPosix)
              D.float)'
            - '                |> D.field "ctime"'
            - '                |> D.maybe'
            - '                |> D.map (Maybe.withDefault (Time.millisToPosix 0))'
            - '                |> decodeApply)'
            - '            |> (D.string'
            - '                |> D.field "description"'
            - '                |> D.maybe'
            - '                |> D.map (Maybe.withDefault (""))'
            - '                |> decodeApply)'
            - '            |> ((D.map ((\f -> f * 1000.0) >> round >> Time.millisToPosix)
              D.float)'
            - '                |> D.field "dueDate"'
            - '                |> D.maybe'
            - '                |> D.map (Maybe.withDefault (Time.millisToPosix 0))'
            - '                |> decodeApply)'
            - '            |> (D.string'
            - '                |> D.field "id"'
            - '                |> D.maybe'
            - '                |> D.map (Maybe.withDefault (""))'
            - '                |> decodeApply)'
            - '            |> (D.list (D.string)'
            - '                |> D.field "tags"'
            - '                |> D.maybe'
            - '                |> D.map (Maybe.withDefault ([]))'
            - '                |> decodeApply)'
            - '    '
            - ""
            - ""
            - ""
            - type alias InputForDelete =
            - '    (String)'
            - ""
            - 'encodeInputForDelete : InputForDelete -> E.Value'
            - encodeInputForDelete
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ E.string arg0'
            - '            ]'
            - ""
            - 'decodeInputForDelete : D.Decoder InputForDelete'
            - decodeInputForDelete =
            - '        D.string'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (""))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias OutputForDelete =
            - '    (Item)'
            - ""
            - 'encodeOutputForDelete : OutputForDelete -> E.Value'
            - encodeOutputForDelete
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ encodeItem arg0'
            - '            ]'
            - ""
            - 'decodeOutputForDelete : D.Decoder OutputForDelete'
            - decodeOutputForDelete =
            - '        decodeItem'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (defaultItem))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias InputForGet =
            - '    (String)'
            - ""
            - 'encodeInputForGet : InputForGet -> E.Value'
            - encodeInputForGet
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ E.string arg0'
            - '            ]'
            - ""
            - 'decodeInputForGet : D.Decoder InputForGet'
            - decodeInputForGet =
            - '        D.string'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (""))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias OutputForGet =
            - '    (Item)'
            - ""
            - 'encodeOutputForGet : OutputForGet -> E.Value'
            - encodeOutputForGet
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ encodeItem arg0'
            - '            ]'
            - ""
            - 'decodeOutputForGet : D.Decoder OutputForGet'
            - decodeOutputForGet =
            - '        decodeItem'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (defaultItem))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias InputForList =
            - '    (())'
            - ""
            - 'encodeInputForList : InputForList -> E.Value'
            - encodeInputForList
            - '    () ='
            - '        E.list (identity)'
            - '            ['
            - '            ]'
            - ""
            - 'decodeInputForList : D.Decoder InputForList'
            - decodeInputForList =
            - '        D.succeed ()'
            - ""
            - type alias OutputForList =
            - '    (List (Item))'
            - ""
            - 'encodeOutputForList : OutputForList -> E.Value'
            - encodeOutputForList
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ E.list (encodeItem) arg0'
            - '            ]'
            - ""
            - 'decodeOutputForList : D.Decoder OutputForList'
            - decodeOutputForList =
            - '        D.list (decodeItem)'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault ([]))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias InputForPut =
            - '    (String)'
            - ""
            - 'encodeInputForPut : InputForPut -> E.Value'
            - encodeInputForPut
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ E.string arg0'
            - '            ]'
            - ""
            - 'decodeInputForPut : D.Decoder InputForPut'
            - decodeInputForPut =
            - '        D.string'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (""))'
            - '            |> D.map (\a -> (a))'
            - ""
            - type alias OutputForPut =
            - '    (Item)'
            - ""
            - 'encodeOutputForPut : OutputForPut -> E.Value'
            - encodeOutputForPut
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ encodeItem arg0'
            - '            ]'
            - ""
            - 'decodeOutputForPut : D.Decoder OutputForPut'
            - decodeOutputForPut =
            - '        decodeItem'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (defaultItem))'
            - '            |> D.map (\a -> (a))'
            - ""
            - ""
            - ""
            - 'callDelete : Config -> InputForDelete -> (CallResult OutputForDelete
              -> a) -> Cmd a'
            - callDelete config input mapResult =
            - '    let'
            - '        body = Http.jsonBody (encodeInputForDelete input)'
            - '        expect = Http.expectJson (unwrapHttpResult >> mapResult) (decodeCallResult
              decodeOutputForDelete)'
            - '    in'
            - '    Http.request'
            - '        { method = "POST"'
            - '        , headers = config.headers'
            - '        , url = config.baseUrl ++ "/rpc/todos/Delete"'
            - '        , body = body'
            - '        , expect = expect'
            - '        , timeout = Nothing'
            - '        , tracker = Nothing'
            - '        }'
            - ""
            - 'callGet : Config -> InputForGet -> (CallResult OutputForGet -> a) ->
              Cmd a'
            - callGet config input mapResult =
            - '    let'
            - '        body = Http.jsonBody (encodeInputForGet input)'
            - '        expect = Http.expectJson (unwrapHttpResult >> mapResult) (decodeCallResult
              decodeOutputForGet)'
            - '    in'
            - '    Http.request'
            - '        { method = "POST"'
            - '        , headers = config.headers'
            - '        , url = config.baseUrl ++ "/rpc/todos/Get"'
            - '        , body = body'
            - '        , expect = expect'
            - '        , timeout = Nothing'
            - '        , tracker = Nothing'
            - '        }'
            - ""
            - 'callList : Config -> InputForList -> (CallResult OutputForList -> a)
              -> Cmd a'
            - callList config input mapResult =
            - '    let'
            - '        body = Http.jsonBody (encodeInputForList input)'
            - '        expect = Http.expectJson (unwrapHttpResult >> mapResult) (decodeCallResult
              decodeOutputForList)'
            - '    in'
            - '    Http.request'
            - '        { method = "POST"'
            - '        , headers = config.headers'
            - '        , url = config.baseUrl ++ "/rpc/todos/List"'
            - '        , body = body'
            - '        , expect = expect'
            - '        , timeout = Nothing'
            - '        , tracker = Nothing'
            - '        }'
            - ""
            - 'callPut : Config -> InputForPut -> (CallResult OutputForPut -> a) ->
              Cmd a'
            - callPut config input mapResult =
            - '    let'
            - '        body = Http.jsonBody (encodeInputForPut input)'
            - '        expect = Http.expectJson (unwrapHttpResult >> mapResult) (decodeCallResult
              decodeOutputForPut)'
            - '    in'
            - '    Http.request'
            - '        { method = "POST"'
            - '        , headers = config.headers'
            - '        , url = config.baseUrl ++ "/rpc/todos/Put"'
            - '        , body = body'
            - '        , expect = expect'
            - '        , timeout = Nothing'
            - '        , tracker = Nothing'
            - '        }'
            - ""
            - module Rpc.System exposing (..)
            - ""
            - import Http
            - import Json.Decode as D
            - import Json.Encode as E
            - import Dict exposing (Dict)
            - import Time exposing (Posix)
            - import Bytes exposing (Bytes)
            - import Bytes.Encode
            - import RpcUtil exposing (Config, CallResult, unwrapHttpResult, decodeCallResult,
              decodeApply)
            - import Rpc
            - ""
            - ""
            - ""
            - ""
            - ""
            - type alias InputForStatus =
            - '    (())'
            - ""
            - 'encodeInputForStatus : InputForStatus -> E.Value'
            - encodeInputForStatus
            - '    () ='
            - '        E.list (identity)'
            - '            ['
            - '            ]'
            - ""
            - 'decodeInputForStatus : D.Decoder InputForStatus'
            - decodeInputForStatus =
            - '        D.succeed ()'
            - ""
            - type alias OutputForStatus =
            - '    (Rpc.Failure)'
            - ""
            - 'encodeOutputForStatus : OutputForStatus -> E.Value'
            - encodeOutputForStatus
            - '    (arg0) ='
            - '        E.list (identity)'
            - '            [ Rpc.encodeFailure arg0'
            - '            ]'
            - ""
            - 'decodeOutputForStatus : D.Decoder OutputForStatus'
            - decodeOutputForStatus =
            - '        Rpc.decodeFailure'
            - '            |> D.index 0'
            - '            |> D.maybe'
            - '            |> D.map (Maybe.withDefault (Rpc.defaultFailure))'
            - '            |> D.map (\a -> (a))'
            - ""
            - ""
            - ""
            - 'callStatus : Config -> InputForStatus -> (CallResult OutputForStatus
              -> a) -> Cmd a'
            - callStatus config input mapResult =
            - '    let'
            - '        body = Http.jsonBody (encodeInputForStatus input)'
            - '        expect = Http.expectJson (unwrapHttpResult >> mapResult) (decodeCallResult
              decodeOutputForStatus)'
            - '    in'
            - '    Http.request'
            - '        { method = "POST"'
            - '        , headers = config.headers'
            - '        , url = config.baseUrl ++ "/rpc/system/Status"'
            - '        , body = body'
            - '        , expect = expect'
            - '        , timeout = Nothing'
            - '        , tracker = Nothing'
            - '        }'
            - ""
            - module Rpc.System.Auth exposing (..)
            - ""
            - import Http
            - import Json.Decode as D
            - import Json.Encode as E
            - import Dict exposing (Dict)
            - import Time exposing (Posix)
            - import Bytes exposing (Bytes)
            - import Bytes.Encode
            - import RpcUtil exposing (Config, CallResult, unwrapHttpResult, decodeCallResult,
              decodeApply)
            - import Rpc
            - ""
            - ""
            - ""
            - type alias AuthRequest =
            - '    { authData : Bytes'
            - '    , provider : String'
            - '    , username : String'
            - '    }'
            - ""
            - 'defaultAuthRequest : AuthRequest'
            - defaultAuthRequest =
            - '    { authData = RpcUtil.emptyBytes'
            - '    , provider = ""'
            - '    , username = ""'
            - '    }'
            - ""
            - 'encodeAuthRequest : AuthRequest -> E.Value'
            - encodeAuthRequest obj =
            - '    E.object'
            - '        [ ( "authData", (RpcUtil.b64StringFromBytes >> Maybe.withDefault
              "" >> E.string) obj.authData )'
            - '        , ( "provider", E.string obj.provider )'
            - '        , ( "username", E.string obj.username )'
            - '        ]'
            - ""
            - 'decodeAuthRequest : D.Decoder AuthRequest'
            - decodeAuthRequest =
            - '    D.map3 AuthRequest'
            - '                ((D.map (Maybe.withDefault "" >> RpcUtil.b64StringToBytes
              >> Maybe.withDefault (Bytes.Encode.encode (Bytes.Encode.string "")))
              (D.maybe D.string))'
            - '                    |> D.field "authData"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (RpcUtil.emptyBytes))'
            - '                )'
            - '                (D.string'
            - '                    |> D.field "provider"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '                (D.string'
            - '                    |> D.field "username"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '    '
            - ""
            - type alias AuthResponse =
            - '    { failure : Rpc.Failure'
            - '    , user : User'
            - '    }'
            - ""
            - 'defaultAuthResponse : AuthResponse'
            - defaultAuthResponse =
            - '    { failure = Rpc.defaultFailure'
            - '    , user = defaultUser'
            - '    }'
            - ""
            - 'encodeAuthResponse : AuthResponse -> E.Value'
            - encodeAuthResponse obj =
            - '    E.object'
            - '        [ ( "failure", Rpc.encodeFailure obj.failure )'
            - '        , ( "user", encodeUser obj.user )'
            - '        ]'
            - ""
            - 'decodeAuthResponse : D.Decoder AuthResponse'
            - decodeAuthResponse =
            - '    D.map2 AuthResponse'
            - '                (Rpc.decodeFailure'
            - '                    |> D.field "failure"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (Rpc.defaultFailure))'
            - '                )'
            - '                (decodeUser'
            - '                    |> D.field "user"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (defaultUser))'
            - '                )'
            - '    '
            - ""
            - type alias User =
            - '    { email : String'
            - '    , metadata : Dict (String) (String)'
            - '    , username : String'
            - '    }'
            - ""
            - 'defaultUser : User'
            - defaultUser =
            - '    { email = ""'
            - '    , metadata = Dict.empty'
            - '    , username = ""'
            - '    }'
            - ""
            - 'encodeUser : User -> E.Value'
            - encodeUser obj =
            - '    E.object'
            - '        [ ( "email", E.string obj.email )'
            - '        , ( "metadata", E.dict (identity) (E.string) obj.metadata )'
            - '        , ( "username", E.string obj.username )'
            - '        ]'
            - ""
            - 'decodeUser : D.Decoder User'
            - decodeUser =
            - '    D.map3 User'
            - '                (D.string'
            - '                    |> D.field "email"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '                (D.dict (D.string)'
            - '                    |> D.field "metadata"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (Dict.empty))'
            - '                )'
            - '                (D.string'
            - '                    |> D.field "username"'
            - '                    |> D.maybe'
            - '                    |> D.map (Maybe.withDefault (""))'
            - '                )'
            - '    '
            - ""
            - ""
            - ""
            - ""
            - ""
            - module RpcUtil exposing
            - '    ( CallResult(..)'
            - '    , Config'
            - '    , b64StringFromBytes'
            - '    , b64StringToBytes'
            - '    , decodeApply'
            - '    , decodeCallResult'
            - '    , decodeConfig'
            - '    , emptyBytes'
            - '    , mapResult'
            - '    , translateHttpError'
            - '    , unwrapHttpResult'
            - '    )'
            - ""
            - import Array exposing (Array)
            - import Bitwise as Bits
            - import Bytes exposing (Bytes)
            - import Bytes.Decode as BytesDec
            - import Bytes.Encode as BytesEnc
            - import Dict exposing (Dict)
            - import Http exposing (Error(..))
            - import Json.Decode as JsonDec
            - ""
            - ""
            - type alias Config =
            - '    { baseUrl : String'
            - '    , headers : List Http.Header'
            - '    }'
            - ""
            - ""
            - 'decodeConfig : JsonDec.Decoder Config'
            - decodeConfig =
            - '    let'
            - '        mapHeader : Array String -> Http.Header'
            - '        mapHeader arr ='
            - '            let'
            - '                header ='
            - '                    Array.get 0 arr |> Maybe.withDefault ""'
            - ""
            - '                content ='
            - '                    Array.get 1 arr |> Maybe.withDefault ""'
            - '            in'
            - '            Http.header header content'
            - ""
            - '        mapHeaderArray : Array (Array String) -> List Http.Header'
            - '        mapHeaderArray arr ='
            - '            arr |> Array.map mapHeader |> Array.toList'
            - '    in'
            - '    JsonDec.map2 Config'
            - '        (JsonDec.field "baseUrl" <| JsonDec.string)'
            - '        (JsonDec.field "headers" <| JsonDec.map mapHeaderArray (JsonDec.array
              (JsonDec.array JsonDec.string)))'
            - ""
            - ""
            - 'decodeApply : JsonDec.Decoder a -> JsonDec.Decoder (a -> b) -> JsonDec.Decoder
              b'
            - decodeApply fieldDec partial =
            - '    JsonDec.andThen (\p -> JsonDec.map p fieldDec) partial'
            - ""
            - ""
            - type CallResult a
            - '    = HttpError Http.Error'
            - '    | ApiError String'
            - '    | Success a'
            - ""
            - ""
            - 'translateHttpError : Http.Error -> String'
            - translateHttpError httpErr =
            - '    case httpErr of'
            - '        BadUrl str ->'
            - '            "Bad URL: " ++ str'
            - ""
            - '        Timeout ->'
            - '            "Network Timeout"'
            - ""
            - '        NetworkError ->'
            - '            "Network Error"'
            - ""
            - '        BadStatus code ->'
            - '            "Bad Status Code: " ++ String.fromInt code'
            - ""
            - '        BadBody str ->'
            - '            "Malformed Response: " ++ str'
            - ""
            - ""
            - 'mapResult : { onHttpErr : Http.Error -> msg, onApiErr : String -> msg,
              onSuccess : a -> msg } -> CallResult a -> msg'
            - mapResult mapper result =
            - '    case result of'
            - '        HttpError httpErr ->'
            - '            mapper.onHttpErr httpErr'
            - ""
            - '        ApiError err ->'
            - '            mapper.onApiErr err'
            - ""
            - '        Success obj ->'
            - '            mapper.onSuccess obj'
            - ""
            - ""
            - 'unwrapHttpResult : Result Http.Error (CallResult a) -> CallResult a'
            - unwrapHttpResult result =
            - '    case result of'
            - '        Ok callResult ->'
            - '            callResult'
            - ""
            - '        Err httpErr ->'
            - '            HttpError httpErr'
            - ""
            - ""
            - 'decodeCallResult : JsonDec.Decoder a -> JsonDec.Decoder (CallResult
              a)'
            - decodeCallResult decodeReturns =
            - '    let'
            - '        mapResultObj : Maybe String -> a -> CallResult a'
            - '        mapResultObj err ret ='
            - '            case err of'
            - '                Just str ->'
            - '                    ApiError str'
            - ""
            - '                Nothing ->'
            - '                    Success ret'
            - '    in'
            - '    JsonDec.map2 mapResultObj'
            - '        (JsonDec.field "error" (JsonDec.maybe JsonDec.string))'
            - '        (JsonDec.field "returns" decodeReturns)'
            - ""
            - ""
            - 'emptyBytes : Bytes'
            - emptyBytes =
            - '    BytesEnc.encode (BytesEnc.sequence [])'
            - ""
            - ""
            - 'stringToBytes : String -> Bytes'
            - stringToBytes str =
            - '    BytesEnc.encode (BytesEnc.string str)'
            - ""
            - ""
            - 'stringFromBytes : Bytes -> Maybe String'
            - stringFromBytes bytes =
            - '    BytesDec.decode (BytesDec.string (Bytes.width bytes)) bytes'
            - ""
            - ""
            - 'b64StringToBytes : String -> Maybe Bytes'
            - b64StringToBytes str =
            - '    decodeB64Chars (String.toList str)'
            - '        |> Maybe.map (BytesEnc.sequence >> BytesEnc.encode)'
            - ""
            - ""
            - 'decodeB64Chars : List Char -> Maybe (List BytesEnc.Encoder)'
            - decodeB64Chars l =
            - '    case l of'
            - '        [] ->'
            - '            Just []'
            - ""
            - '        a :: b :: ''='' :: ''='' :: [] ->'
            - '            b64Dec2 a b |> Maybe.map List.singleton'
            - ""
            - '        a :: b :: [] ->'
            - '            b64Dec2 a b |> Maybe.map List.singleton'
            - ""
            - '        a :: b :: c :: ''='' :: [] ->'
            - '            b64Dec3 a b c |> Maybe.map List.singleton'
            - ""
            - '        a :: b :: c :: [] ->'
            - '            b64Dec3 a b c |> Maybe.map List.singleton'
            - ""
            - '        a :: b :: c :: d :: tail ->'
            - '            case ( b64Dec4 a b c d, decodeB64Chars tail ) of'
            - '                ( Just e, Just list ) ->'
            - '                    Just <| e :: list'
            - ""
            - '                _ ->'
            - '                    Nothing'
            - ""
            - '        _ ->'
            - '            Nothing'
            - ""
            - ""
            - 'b64StringFromBytes : Bytes -> Maybe String'
            - b64StringFromBytes bytes =
            - '    let'
            - '        get3 ='
            - '            BytesDec.map3 b64Enc3 BytesDec.unsignedInt8 BytesDec.unsignedInt8
              BytesDec.unsignedInt8'
            - ""
            - '        get2 ='
            - '            BytesDec.map2 b64Enc2 BytesDec.unsignedInt8 BytesDec.unsignedInt8'
            - ""
            - '        get1 ='
            - '            BytesDec.map b64Enc1 BytesDec.unsignedInt8'
            - ""
            - '        process : B64State -> BytesDec.Decoder (BytesDec.Step B64State
              (List Char))'
            - '        process state ='
            - '            if state.processed >= state.total then'
            - '                BytesDec.succeed <| BytesDec.Done state.output'
            - ""
            - '            else'
            - '                BytesDec.map BytesDec.Loop <|'
            - '                    case state.total - state.processed of'
            - '                        1 ->'
            - '                            get1 |> BytesDec.map (appendB64State 1
              state)'
            - ""
            - '                        2 ->'
            - '                            get2 |> BytesDec.map (appendB64State 2
              state)'
            - ""
            - '                        _ ->'
            - '                            -- 3 or more'
            - '                            get3 |> BytesDec.map (appendB64State 3
              state)'
            - ""
            - '        decoder ='
            - '            BytesDec.loop (initialB64State bytes) process'
            - '                |> BytesDec.map String.fromList'
            - '    in'
            - '    BytesDec.decode decoder bytes'
            - ""
            - ""
            - '{-| base64 1111 1122 2222 3333 3344 4444'
            - '|||| bytes 1111 1111 2222 2222 3333 3333'
            - -}
            - 'b64Dec4 : Char -> Char -> Char -> Char -> Maybe BytesEnc.Encoder'
            - b64Dec4 a b c d =
            - '    case [ toB64byte a, toB64byte b, toB64byte c, toB64byte d ] of'
            - '        [ Just aa, Just bb, Just cc, Just dd ] ->'
            - '            Just <|'
            - '                BytesEnc.sequence'
            - '                    [ BytesEnc.unsignedInt8 ((aa |> Bits.shiftLeftBy
              2) + (bb |> Bits.shiftRightZfBy 4))'
            - '                    , BytesEnc.unsignedInt8 ((bb |> Bits.shiftLeftBy
              4) + (cc |> Bits.shiftRightZfBy 2))'
            - '                    , BytesEnc.unsignedInt8 ((cc |> Bits.shiftLeftBy
              6) + dd)'
            - '                    ]'
            - ""
            - '        _ ->'
            - '            Nothing'
            - ""
            - ""
            - '{-| base64 1111 1122 2222 3333 33'
            - '|||| bytes 1111 1111 2222 2222 ..'
            - -}
            - 'b64Dec3 : Char -> Char -> Char -> Maybe BytesEnc.Encoder'
            - b64Dec3 a b c =
            - '    case ( toB64byte a, toB64byte b, toB64byte c ) of'
            - '        ( Just aa, Just bb, Just cc ) ->'
            - '            Just <|'
            - '                BytesEnc.sequence'
            - '                    [ BytesEnc.unsignedInt8 ((aa |> Bits.shiftLeftBy
              2) + (bb |> Bits.shiftRightZfBy 4))'
            - '                    , BytesEnc.unsignedInt8 ((bb |> Bits.shiftLeftBy
              4) + (cc |> Bits.shiftRightZfBy 2))'
            - '                    ]'
            - ""
            - '        _ ->'
            - '            Nothing'
            - ""
            - ""
            - '{-| base64 1111 1122 2222 ....'
            - '|||| bytes 1111 1111 .... ....'
            - -}
            - 'b64Dec2 : Char -> Char -> Maybe BytesEnc.Encoder'
            - b64Dec2 a b =
            - '    case ( toB64byte a, toB64byte b ) of'
            - '        ( Just aa, Just bb ) ->'
            - '            Just <| BytesEnc.unsignedInt8 ((aa |> Bits.shiftLeftBy
              2) + (bb |> Bits.shiftRightZfBy 4))'
            - ""
            - '        _ ->'
            - '            Nothing'
            - ""
            - ""
            - '{-| bytes 1111 1111 2222 2222 3333 3333'
            - '|| base64 1111 1122 2222 3333 3344 4444'
            - -}
            - 'b64Enc3 : Int -> Int -> Int -> List Char'
            - b64Enc3 a b c =
            - '    [ Bits.shiftRightBy 2 a |> Bits.and 0x3F |> toB64char'
            - '    , (Bits.shiftLeftBy 4 a + Bits.shiftRightBy 4 b) |> Bits.and 0x3F
              |> toB64char'
            - '    , (Bits.shiftLeftBy 2 b + Bits.shiftRightBy 6 c) |> Bits.and 0x3F
              |> toB64char'
            - '    , c |> Bits.and 0x3F |> toB64char'
            - '    ]'
            - ""
            - ""
            - '{-| bytes 1111 1111 2222 2222 .... ....'
            - '|| base64 1111 1122 2222 3333 33.. ....'
            - -}
            - 'b64Enc2 : Int -> Int -> List Char'
            - b64Enc2 a b =
            - '    [ Bits.shiftRightBy 2 a |> Bits.and 0x3F |> toB64char'
            - '    , (Bits.shiftLeftBy 4 a + Bits.shiftRightBy 4 b) |> Bits.and 0x3F
              |> toB64char'
            - '    , Bits.shiftLeftBy 2 b |> Bits.and 0x3F |> toB64char'
            - '    , ''='''
            - '    ]'
            - ""
            - ""
            - '{-| bytes 1111 1111 .... ....'
            - '|| base64 1111 1122 2222 ....'
            - -}
            - 'b64Enc1 : Int -> List Char'
            - b64Enc1 a =
            - '    [ Bits.shiftRightBy 2 a |> Bits.and 0x3F |> toB64char'
            - '    , Bits.shiftLeftBy 4 a |> Bits.and 0x3F |> toB64char'
            - '    , ''='''
            - '    , ''='''
            - '    ]'
            - ""
            - ""
            - type alias B64State =
            - '    { total : Int'
            - '    , processed : Int'
            - '    , output : List Char'
            - '    }'
            - ""
            - ""
            - 'initialB64State : Bytes -> B64State'
            - initialB64State bytes =
            - '    { total = Bytes.width bytes'
            - '    , processed = 0'
            - '    , output = []'
            - '    }'
            - ""
            - ""
            - 'appendB64State : Int -> B64State -> List Char -> B64State'
            - appendB64State count state chars =
            - '    { state'
            - '        | processed = state.processed + count'
            - '        , output = List.append state.output chars'
            - '    }'
            - ""
            - ""
            - 'toB64byte : Char -> Maybe Int'
            - toB64byte c =
            - '    Dict.get c b64BackwardTable'
            - ""
            - ""
            - 'toB64char : Int -> Char'
            - toB64char n =
            - '    Dict.get n b64ForwardTable'
            - '        |> Maybe.withDefault ''?'''
            - ""
            - ""
            - 'b64BackwardTable : Dict Char Int'
            - b64BackwardTable =
            - '    Dict.fromList'
            - '        [ ( ''A'', 0 )'
            - '        , ( ''B'', 1 )'
            - '        , ( ''C'', 2 )'
            - '        , ( ''D'', 3 )'
            - '        , ( ''E'', 4 )'
            - '        , ( ''F'', 5 )'
            - '        , ( ''G'', 6 )'
            - '        , ( ''H'', 7 )'
            - '        , ( ''I'', 8 )'
            - '        , ( ''J'', 9 )'
            - '        , ( ''K'', 10 )'
            - '        , ( ''L'', 11 )'
            - '        , ( ''M'', 12 )'
            - '        , ( ''N'', 13 )'
            - '        , ( ''O'', 14 )'
            - '        , ( ''P'', 15 )'
            - '        , ( ''Q'', 16 )'
            - '        , ( ''R'', 17 )'
            - '        , ( ''S'', 18 )'
            - '        , ( ''T'', 19 )'
            - '        , ( ''U'', 20 )'
            - '        , ( ''V'', 21 )'
            - '        , ( ''W'', 22 )'
            - '        , ( ''X'', 23 )'
            - '        , ( ''Y'', 24 )'
            - '        , ( ''Z'', 25 )'
            - '        , ( ''a'', 26 )'
            - '        , ( ''b'', 27 )'
            - '        , ( ''c'', 28 )'
            - '        , ( ''d'', 29 )'
            - '        , ( ''e'', 30 )'
            - '        , ( ''f'', 31 )'
            - '        , ( ''g'', 32 )'
            - '        , ( ''h'', 33 )'
            - '        , ( ''i'', 34 )'
            - '        , ( ''j'', 35 )'
            - '        , ( ''k'', 36 )'
            - '        , ( ''l'', 37 )'
            - '        , ( ''m'', 38 )'
            - '        , ( ''n'', 39 )'
            - '        , ( ''o'', 40 )'
            - '        , ( ''p'', 41 )'
            - '        , ( ''q'', 42 )'
            - '        , ( ''r'', 43 )'
            - '        , ( ''s'', 44 )'
            - '        , ( ''t'', 45 )'
            - '        , ( ''u'', 46 )'
            - '        , ( ''v'', 47 )'
            - '        , ( ''w'', 48 )'
            - '        , ( ''x'', 49 )'
            - '        , ( ''y'', 50 )'
            - '        , ( ''z'', 51 )'
            - '        , ( ''0'', 52 )'
            - '        , ( ''1'', 53 )'
            - '        , ( ''2'', 54 )'
            - '        , ( ''3'', 55 )'
            - '        , ( ''4'', 56 )'
            - '        , ( ''5'', 57 )'
            - '        , ( ''6'', 58 )'
            - '        , ( ''7'', 59 )'
            - '        , ( ''8'', 60 )'
            - '        , ( ''9'', 61 )'
            - '        , ( ''-'', 62 )'
            - '        , ( ''_'', 63 )'
            - '        ]'
            - ""
            - ""
            - 'b64ForwardTable : Dict Int Char'
            - b64ForwardTable =
            - '    Dict.fromList'
            - '        [ ( 0, ''A'' )'
            - '        , ( 1, ''B'' )'
            - '        , ( 2, ''C'' )'
            - '        , ( 3, ''D'' )'
            - '        , ( 4, ''E'' )'
            - '        , ( 5, ''F'' )'
            - '        , ( 6, ''G'' )'
            - '        , ( 7, ''H'' )'
            - '        , ( 8, ''I'' )'
            - '        , ( 9, ''J'' )'
            - '        , ( 10, ''K'' )'
            - '        , ( 11, ''L'' )'
            - '        , ( 12, ''M'' )'
            - '        , ( 13, ''N'' )'
            - '        , ( 14, ''O'' )'
            - '        , ( 15, ''P'' )'
            - '        , ( 16, ''Q'' )'
            - '        , ( 17, ''R'' )'
            - '        , ( 18, ''S'' )'
            - '        , ( 19, ''T'' )'
            - '        , ( 20, ''U'' )'
            - '        , ( 21, ''V'' )'
            - '        , ( 22, ''W'' )'
            - '        , ( 23, ''X'' )'
            - '        , ( 24, ''Y'' )'
            - '        , ( 25, ''Z'' )'
            - '        , ( 26, ''a'' )'
            - '        , ( 27, ''b'' )'
            - '        , ( 28, ''c'' )'
            - '        , ( 29, ''d'' )'
            - '        , ( 30, ''e'' )'
            - '        , ( 31, ''f'' )'
            - '        , ( 32, ''g'' )'
            - '        , ( 33, ''h'' )'
            - '        , ( 34, ''i'' )'
            - '        , ( 35, ''j'' )'
            - '        , ( 36, ''k'' )'
            - '        , ( 37, ''l'' )'
            - '        , ( 38, ''m'' )'
            - '        , ( 39, ''n'' )'
            - '        , ( 40, ''o'' )'
            - '        , ( 41, ''p'' )'
            - '        , ( 42, ''q'' )'
            - '        , ( 43, ''r'' )'
            - '        , ( 44, ''s'' )'
            - '        , ( 45, ''t'' )'
            - '        , ( 46, ''u'' )'
            - '        , ( 47, ''v'' )'
            - '        , ( 48, ''w'' )'
            - '        , ( 49, ''x'' )'
            - '        , ( 50, ''y'' )'
            - '        , ( 51, ''z'' )'
            - '        , ( 52, ''0'' )'
            - '        , ( 53, ''1'' )'
            - '        , ( 54, ''2'' )'
            - '        , ( 55, ''3'' )'
            - '        , ( 56, ''4'' )'
            - '        , ( 57, ''5'' )'
            - '        , ( 58, ''6'' )'
            - '        , ( 59, ''7'' )'
            - '        , ( 60, ''8'' )'
            - '        , ( 61, ''9'' )'
            - '        , ( 62, ''-'' )'
            - '        , ( 63, ''_'' )'
            - '        ]'
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Generators \ Go
  commands:
    - command: rm -r /tmp/rpc >/dev/null 2>&1 || true
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Generators \ Go \ Simple
  commands:
    - command: rm -r /tmp/rpc >/dev/null 2>&1 || true
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -gen go -out /tmp/rpc/go todo-simple.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/go -name "*.go"
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - /tmp/rpc/go/server/server.go
            - /tmp/rpc/go/rpc.go
            - /tmp/rpc/go/client/client.go
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/go -name "*.go" | xargs cat
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - // <auto-generated />
            - //
            - '// expected import: go.example.com/rpc/server'
            - package server
            - ""
            - import (
            - "\t\"bytes\""
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"io\""
            - "\t\"net/http\""
            - ""
            - "\trpc_root \"go.example.com/rpc\""
            - )
            - ""
            - type Handler_rpc_root struct {
            - "\tHandler rpc_root.Interface"
            - '}'
            - ""
            - type Result struct {
            - "\tError   error         `json:\"error\"`"
            - "\tReturns []interface{} `json:\"returns\"`"
            - '}'
            - ""
            - type Server struct {
            - "\toptions Options"
            - "\tHandler_rpc_root"
            - '}'
            - ""
            - type Options struct {
            - "\tAddr      string"
            - "\tCtxFilter func(req *http.Request, method string) context.Context"
            - "\tErrFilter func(req *http.Request, method string, err error) error"
            - "\tErrLog    func(req *http.Request, method string, err error)"
            - '}'
            - ""
            - func New(opts *Options) *Server {
            - "\tsrv := &Server{options: *opts}"
            - "\tif srv.options.CtxFilter == nil {"
            - "\t\tsrv.options.CtxFilter = func(req *http.Request, _ string) context.Context
              {"
            - "\t\t\treturn req.Context()"
            - "\t\t}"
            - "\t}"
            - "\tif srv.options.ErrFilter == nil {"
            - "\t\tsrv.options.ErrFilter = func(_ *http.Request, _ string, err error)
              error {"
            - "\t\t\treturn err"
            - "\t\t}"
            - "\t}"
            - "\treturn srv"
            - '}'
            - ""
            - func (s *Server) Listen() error {
            - "\treturn http.ListenAndServe(s.options.Addr, s.HTTPHandler())"
            - '}'
            - ""
            - func (s *Server) HTTPHandler() http.Handler {
            - "\tmux := http.NewServeMux()"
            - "\ts.register_rpc_root(mux, s.Handler_rpc_root)"
            - "\treturn mux"
            - '}'
            - ""
            - func (s *Server) register_rpc_root(
            - "\tmux *http.ServeMux,"
            - "\thandler Handler_rpc_root,"
            - ) *http.ServeMux {
            - ""
            - "\tmux.HandleFunc(\"/minitodo/Delete\", func(resp http.ResponseWriter,
              req *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"minitodo/Delete\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar arg0 string"
            - "\t\targs := [1]interface{}{"
            - "\t\t\t&arg0,"
            - "\t\t}"
            - ""
            - "\t\tif req.Body != nil {"
            - "\t\t\tif err := json.NewDecoder(req.Body).Decode(&args); err != nil
              {"
            - "\t\t\t\tresp.WriteHeader(400)"
            - "\t\t\t\trenderError(resp, err)"
            - "\t\t\t\treturn"
            - "\t\t\t}"
            - "\t\t}"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 *rpc_root.TodoItem"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.Delete("
            - "\t\t\tctx, arg0)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"minitodo/Delete\", err)"
            - "\t\t\ts.options.ErrLog(req, \"minitodo/Delete\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\tmux.HandleFunc(\"/minitodo/Get\", func(resp http.ResponseWriter,
              req *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"minitodo/Get\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar arg0 string"
            - "\t\targs := [1]interface{}{"
            - "\t\t\t&arg0,"
            - "\t\t}"
            - ""
            - "\t\tif req.Body != nil {"
            - "\t\t\tif err := json.NewDecoder(req.Body).Decode(&args); err != nil
              {"
            - "\t\t\t\tresp.WriteHeader(400)"
            - "\t\t\t\trenderError(resp, err)"
            - "\t\t\t\treturn"
            - "\t\t\t}"
            - "\t\t}"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 *rpc_root.TodoItem"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.Get("
            - "\t\t\tctx, arg0)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"minitodo/Get\", err)"
            - "\t\t\ts.options.ErrLog(req, \"minitodo/Get\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\tmux.HandleFunc(\"/minitodo/List\", func(resp http.ResponseWriter,
              req *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"minitodo/List\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 []*rpc_root.TodoItem"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.List("
            - "\t\t\tctx)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"minitodo/List\", err)"
            - "\t\t\ts.options.ErrLog(req, \"minitodo/List\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\tmux.HandleFunc(\"/minitodo/Put\", func(resp http.ResponseWriter,
              req *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"minitodo/Put\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar arg0 *rpc_root.TodoItem"
            - "\t\targs := [1]interface{}{"
            - "\t\t\t&arg0,"
            - "\t\t}"
            - ""
            - "\t\tif req.Body != nil {"
            - "\t\t\tif err := json.NewDecoder(req.Body).Decode(&args); err != nil
              {"
            - "\t\t\t\tresp.WriteHeader(400)"
            - "\t\t\t\trenderError(resp, err)"
            - "\t\t\t\treturn"
            - "\t\t\t}"
            - "\t\t}"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 *rpc_root.TodoItem"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.Put("
            - "\t\t\tctx, arg0)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"minitodo/Put\", err)"
            - "\t\t\ts.options.ErrLog(req, \"minitodo/Put\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\treturn mux"
            - '}'
            - ""
            - func renderError(resp http.ResponseWriter, e error) {
            - "\tresult := &Result{"
            - "\t\tError:   e,"
            - "\t\tReturns: nil,"
            - "\t}"
            - ""
            - "\tbytes, err := json.Marshal(result)"
            - "\tif err != nil {"
            - "\t\t_, _ = resp.Write([]byte(`{\"error\":\"json processing error\"}`))"
            - "\t} else {"
            - "\t\t_, _ = resp.Write(bytes)"
            - "\t}"
            - '}'
            - // <auto-generated />
            - //
            - '// expected import: go.example.com/rpc'
            - package minitodo
            - ""
            - import (
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"math\""
            - ""
            - "\ttime \"time\""
            - )
            - ""
            - var (
            - "\t_ context.Context = nil"
            - "\t_                 = json.Marshal"
            - "\t_                 = math.Pi"
            - )
            - ""
            - type Failure struct {
            - "\tCode        string `json:\"code\" yaml:\"code\" db:\"code\"`"
            - "\tDescription string `json:\"description\" yaml:\"description\" db:\"description\"`"
            - '}'
            - ""
            - func (obj *Failure) MarshalJSON() ([]byte, error) {
            - "\toutobj := struct {"
            - "\t\tCode        string `json:\"code\"`"
            - "\t\tDescription string `json:\"description\"`"
            - "\t}{"
            - "\t\tCode:        (obj.Code),"
            - "\t\tDescription: (obj.Description),"
            - "\t}"
            - "\treturn json.Marshal(outobj)"
            - '}'
            - ""
            - func (obj *Failure) UnmarshalJSON(buf []byte) error {
            - "\tinobj := struct {"
            - "\t\tCode        string `json:\"code\"`"
            - "\t\tDescription string `json:\"description\"`"
            - "\t}{}"
            - ""
            - "\tif err := json.Unmarshal(buf, &inobj); err != nil {"
            - "\t\treturn err"
            - "\t}"
            - ""
            - "\tobj.Code = (inobj.Code)"
            - "\tobj.Description = (inobj.Description)"
            - "\treturn nil"
            - '}'
            - ""
            - type TodoItem struct {
            - "\tCompleted   bool      `json:\"completed\" yaml:\"completed\" db:\"completed\"`"
            - "\tCtime       time.Time `json:\"ctime\" yaml:\"ctime\" db:\"ctime\"`"
            - "\tDescription string    `json:\"description\" yaml:\"description\"
              db:\"description\"`"
            - "\tMetadata    []byte    `json:\"metadata\" yaml:\"metadata\" db:\"metadata\"`"
            - "\tUuid        string    `json:\"uuid\" yaml:\"uuid\" db:\"uuid\"`"
            - '}'
            - ""
            - func (obj *TodoItem) MarshalJSON() ([]byte, error) {
            - "\toutobj := struct {"
            - "\t\tCompleted   bool    `json:\"completed\"`"
            - "\t\tCtime       float64 `json:\"ctime\"`"
            - "\t\tDescription string  `json:\"description\"`"
            - "\t\tMetadata    []byte  `json:\"metadata\"`"
            - "\t\tUuid        string  `json:\"uuid\"`"
            - "\t}{"
            - "\t\tCompleted: (obj.Completed),"
            - "\t\tCtime: (func(t time.Time) float64 {"
            - "\t\t\tsec, nsec := t.Unix(), t.Nanosecond()"
            - "\t\t\treturn float64(sec) + (float64(nsec) / float64(time.Second))"
            - "\t\t})(obj.Ctime),"
            - "\t\tDescription: (obj.Description),"
            - "\t\tMetadata:    (obj.Metadata),"
            - "\t\tUuid:        (obj.Uuid),"
            - "\t}"
            - "\treturn json.Marshal(outobj)"
            - '}'
            - ""
            - func (obj *TodoItem) UnmarshalJSON(buf []byte) error {
            - "\tinobj := struct {"
            - "\t\tCompleted   bool    `json:\"completed\"`"
            - "\t\tCtime       float64 `json:\"ctime\"`"
            - "\t\tDescription string  `json:\"description\"`"
            - "\t\tMetadata    []byte  `json:\"metadata\"`"
            - "\t\tUuid        string  `json:\"uuid\"`"
            - "\t}{}"
            - ""
            - "\tif err := json.Unmarshal(buf, &inobj); err != nil {"
            - "\t\treturn err"
            - "\t}"
            - ""
            - "\tobj.Completed = (inobj.Completed)"
            - "\tobj.Ctime = (func(t float64) time.Time {"
            - "\t\tfsec, fnsec := math.Modf(t)"
            - "\t\tsec, nsec := int64(fsec), int64(math.Round(fnsec*float64(time.Second)))"
            - "\t\treturn time.Unix(sec, nsec)"
            - "\t})(inobj.Ctime)"
            - "\tobj.Description = (inobj.Description)"
            - "\tobj.Metadata = (inobj.Metadata)"
            - "\tobj.Uuid = (inobj.Uuid)"
            - "\treturn nil"
            - '}'
            - ""
            - type Interface interface {
            - "\tDelete(context.Context, string) (*TodoItem, error,"
            - "\t)"
            - "\tGet(context.Context, string) (*TodoItem, error,"
            - "\t)"
            - "\tList(context.Context) ([]*TodoItem, error,"
            - "\t)"
            - "\tPut(context.Context, *TodoItem) (*TodoItem, error,"
            - "\t)"
            - '}'
            - // <auto-generated />
            - //
            - '// expected import: go.example.com/rpc/client'
            - package client
            - ""
            - import (
            - "\t\"bytes\""
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"net/http\""
            - "\t\"time\""
            - ""
            - "\trpc_root \"go.example.com/rpc\""
            - )
            - ""
            - var (
            - "\t_ context.Context = nil"
            - "\t_ time.Time       = time.Time{}"
            - )
            - ""
            - // go.example.com/rpc
            - var _ rpc_root.Interface = Client_rpc_root{}
            - ""
            - type Client_rpc_root struct {
            - "\t*Client"
            - '}'
            - ""
            - func (c *Client_rpc_root) initialize(client *Client) {
            - "\tc.Client = client"
            - '}'
            - ""
            - func (c Client_rpc_root) Delete(
            - "\tctx context.Context,"
            - "\targ0 string,"
            - ) (
            - "\tout0 *rpc_root.TodoItem,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{arg0}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/minitodo/Delete\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - func (c Client_rpc_root) Get(
            - "\tctx context.Context,"
            - "\targ0 string,"
            - ) (
            - "\tout0 *rpc_root.TodoItem,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{arg0}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/minitodo/Get\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - func (c Client_rpc_root) List(
            - "\tctx context.Context,"
            - ) (
            - "\tout0 []*rpc_root.TodoItem,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/minitodo/List\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - func (c Client_rpc_root) Put(
            - "\tctx context.Context,"
            - "\targ0 *rpc_root.TodoItem,"
            - ) (
            - "\tout0 *rpc_root.TodoItem,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{arg0}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/minitodo/Put\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - type Result struct {
            - "\tError   error         `json:\"error\"`"
            - "\tReturns []interface{} `json:\"returns\"`"
            - '}'
            - ""
            - type Client struct {
            - "\tOptions"
            - "\tClient_rpc_root"
            - ""
            - "\tHTTPClient *http.Client"
            - '}'
            - ""
            - type Options struct {
            - "\tAddr string"
            - '}'
            - ""
            - func New(opts *Options) *Client {
            - "\tclient := &Client{"
            - "\t\tOptions:         *opts,"
            - "\t\tClient_rpc_root: Client_rpc_root{},"
            - "\t\tHTTPClient:      &http.Client{},"
            - "\t}"
            - "\tclient.Client_rpc_root.initialize(client)"
            - "\treturn client"
            - '}'
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Generators \ Go \ Complex
  commands:
    - command: rm -r /tmp/rpc >/dev/null 2>&1 || true
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -gen go -out /tmp/rpc/go todo-complex.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/go -name "*.go"
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - /tmp/rpc/go/server/server.go
            - /tmp/rpc/go/system/auth/rpc.go
            - /tmp/rpc/go/system/rpc.go
            - /tmp/rpc/go/rpc.go
            - /tmp/rpc/go/todos/rpc.go
            - /tmp/rpc/go/client/client.go
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/go -name "*.go" | xargs cat
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - // <auto-generated />
            - //
            - '// expected import: github.com/chakrit/rpc/examples/server'
            - package server
            - ""
            - import (
            - "\t\"bytes\""
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"io\""
            - "\t\"net/http\""
            - ""
            - "\trpc_root \"github.com/chakrit/rpc/examples\""
            - "\trpc_system \"github.com/chakrit/rpc/examples/system\""
            - "\trpc_system_auth \"github.com/chakrit/rpc/examples/system/auth\""
            - ""
            - "\trpc_todos \"github.com/chakrit/rpc/examples/todos\""
            - )
            - ""
            - type Handler_rpc_root struct {
            - "\tHandler rpc_root.Interface"
            - "\tSystem  Handler_rpc_system"
            - "\tTodos   Handler_rpc_todos"
            - '}'
            - ""
            - type Handler_rpc_system struct {
            - "\tHandler rpc_system.Interface"
            - "\tAuth    Handler_rpc_system_auth"
            - '}'
            - ""
            - type Handler_rpc_system_auth struct {
            - "\tHandler rpc_system_auth.Interface"
            - '}'
            - ""
            - type Handler_rpc_todos struct {
            - "\tHandler rpc_todos.Interface"
            - '}'
            - ""
            - type Result struct {
            - "\tError   error         `json:\"error\"`"
            - "\tReturns []interface{} `json:\"returns\"`"
            - '}'
            - ""
            - type Server struct {
            - "\toptions Options"
            - "\tHandler_rpc_root"
            - '}'
            - ""
            - type Options struct {
            - "\tAddr      string"
            - "\tCtxFilter func(req *http.Request, method string) context.Context"
            - "\tErrFilter func(req *http.Request, method string, err error) error"
            - "\tErrLog    func(req *http.Request, method string, err error)"
            - '}'
            - ""
            - func New(opts *Options) *Server {
            - "\tsrv := &Server{options: *opts}"
            - "\tif srv.options.CtxFilter == nil {"
            - "\t\tsrv.options.CtxFilter = func(req *http.Request, _ string) context.Context
              {"
            - "\t\t\treturn req.Context()"
            - "\t\t}"
            - "\t}"
            - "\tif srv.options.ErrFilter == nil {"
            - "\t\tsrv.options.ErrFilter = func(_ *http.Request, _ string, err error)
              error {"
            - "\t\t\treturn err"
            - "\t\t}"
            - "\t}"
            - "\treturn srv"
            - '}'
            - ""
            - func (s *Server) Listen() error {
            - "\treturn http.ListenAndServe(s.options.Addr, s.HTTPHandler())"
            - '}'
            - ""
            - func (s *Server) HTTPHandler() http.Handler {
            - "\tmux := http.NewServeMux()"
            - "\ts.register_rpc_root(mux, s.Handler_rpc_root)"
            - "\treturn mux"
            - '}'
            - ""
            - func (s *Server) register_rpc_root(
            - "\tmux *http.ServeMux,"
            - "\thandler Handler_rpc_root,"
            - ) *http.ServeMux {
            - ""
            - "\ts.register_rpc_system(mux, handler.System)"
            - "\ts.register_rpc_todos(mux, handler.Todos)"
            - "\treturn mux"
            - '}'
            - ""
            - func (s *Server) register_rpc_system(
            - "\tmux *http.ServeMux,"
            - "\thandler Handler_rpc_system,"
            - ) *http.ServeMux {
            - ""
            - "\tmux.HandleFunc(\"/examples/system/Status\", func(resp http.ResponseWriter,
              req *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"examples/system/Status\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 *rpc_root.Failure"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.Status("
            - "\t\t\tctx)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"examples/system/Status\", err)"
            - "\t\t\ts.options.ErrLog(req, \"examples/system/Status\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\ts.register_rpc_system_auth(mux, handler.Auth)"
            - "\treturn mux"
            - '}'
            - ""
            - func (s *Server) register_rpc_system_auth(
            - "\tmux *http.ServeMux,"
            - "\thandler Handler_rpc_system_auth,"
            - ) *http.ServeMux {
            - ""
            - "\treturn mux"
            - '}'
            - ""
            - func (s *Server) register_rpc_todos(
            - "\tmux *http.ServeMux,"
            - "\thandler Handler_rpc_todos,"
            - ) *http.ServeMux {
            - ""
            - "\tmux.HandleFunc(\"/examples/todos/Delete\", func(resp http.ResponseWriter,
              req *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"examples/todos/Delete\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar arg0 string"
            - "\t\targs := [1]interface{}{"
            - "\t\t\t&arg0,"
            - "\t\t}"
            - ""
            - "\t\tif req.Body != nil {"
            - "\t\t\tif err := json.NewDecoder(req.Body).Decode(&args); err != nil
              {"
            - "\t\t\t\tresp.WriteHeader(400)"
            - "\t\t\t\trenderError(resp, err)"
            - "\t\t\t\treturn"
            - "\t\t\t}"
            - "\t\t}"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 *rpc_todos.Item"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.Delete("
            - "\t\t\tctx, arg0)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"examples/todos/Delete\", err)"
            - "\t\t\ts.options.ErrLog(req, \"examples/todos/Delete\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\tmux.HandleFunc(\"/examples/todos/Get\", func(resp http.ResponseWriter,
              req *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"examples/todos/Get\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar arg0 string"
            - "\t\targs := [1]interface{}{"
            - "\t\t\t&arg0,"
            - "\t\t}"
            - ""
            - "\t\tif req.Body != nil {"
            - "\t\t\tif err := json.NewDecoder(req.Body).Decode(&args); err != nil
              {"
            - "\t\t\t\tresp.WriteHeader(400)"
            - "\t\t\t\trenderError(resp, err)"
            - "\t\t\t\treturn"
            - "\t\t\t}"
            - "\t\t}"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 *rpc_todos.Item"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.Get("
            - "\t\t\tctx, arg0)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"examples/todos/Get\", err)"
            - "\t\t\ts.options.ErrLog(req, \"examples/todos/Get\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\tmux.HandleFunc(\"/examples/todos/List\", func(resp http.ResponseWriter,
              req *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"examples/todos/List\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 []*rpc_todos.Item"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.List("
            - "\t\t\tctx)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"examples/todos/List\", err)"
            - "\t\t\ts.options.ErrLog(req, \"examples/todos/List\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\tmux.HandleFunc(\"/examples/todos/Put\", func(resp http.ResponseWriter,
              req *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"examples/todos/Put\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar arg0 string"
            - "\t\targs := [1]interface{}{"
            - "\t\t\t&arg0,"
            - "\t\t}"
            - ""
            - "\t\tif req.Body != nil {"
            - "\t\t\tif err := json.NewDecoder(req.Body).Decode(&args); err != nil
              {"
            - "\t\t\t\tresp.WriteHeader(400)"
            - "\t\t\t\trenderError(resp, err)"
            - "\t\t\t\treturn"
            - "\t\t\t}"
            - "\t\t}"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 *rpc_todos.Item"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.Put("
            - "\t\t\tctx, arg0)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"examples/todos/Put\", err)"
            - "\t\t\ts.options.ErrLog(req, \"examples/todos/Put\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\treturn mux"
            - '}'
            - ""
            - func renderError(resp http.ResponseWriter, e error) {
            - "\tresult := &Result{"
            - "\t\tError:   e,"
            - "\t\tReturns: nil,"
            - "\t}"
            - ""
            - "\tbytes, err := json.Marshal(result)"
            - "\tif err != nil {"
            - "\t\t_, _ = resp.Write([]byte(`{\"error\":\"json processing error\"}`))"
            - "\t} else {"
            - "\t\t_, _ = resp.Write(bytes)"
            - "\t}"
            - '}'
            - // <auto-generated />
            - //
            - '// expected import: github.com/chakrit/rpc/examples/system/auth'
            - package auth
            - ""
            - import (
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"math\""
            - ""
            - "\trpc_root \"github.com/chakrit/rpc/examples\""
            - )
            - ""
            - var (
            - "\t_ context.Context = nil"
            - "\t_                 = json.Marshal"
            - "\t_                 = math.Pi"
            - )
            - ""
            - type AuthRequest struct {
            - "\tAuthData []byte `json:\"authData\" yaml:\"authData\" db:\"auth_data\"`"
            - "\tProvider string `json:\"provider\" yaml:\"provider\" db:\"provider\"`"
            - "\tUsername string `json:\"username\" yaml:\"username\" db:\"username\"`"
            - '}'
            - ""
            - func (obj *AuthRequest) MarshalJSON() ([]byte, error) {
            - "\toutobj := struct {"
            - "\t\tAuthData []byte `json:\"authData\"`"
            - "\t\tProvider string `json:\"provider\"`"
            - "\t\tUsername string `json:\"username\"`"
            - "\t}{"
            - "\t\tAuthData: (obj.AuthData),"
            - "\t\tProvider: (obj.Provider),"
            - "\t\tUsername: (obj.Username),"
            - "\t}"
            - "\treturn json.Marshal(outobj)"
            - '}'
            - ""
            - func (obj *AuthRequest) UnmarshalJSON(buf []byte) error {
            - "\tinobj := struct {"
            - "\t\tAuthData []byte `json:\"authData\"`"
            - "\t\tProvider string `json:\"provider\"`"
            - "\t\tUsername string `json:\"username\"`"
            - "\t}{}"
            - ""
            - "\tif err := json.Unmarshal(buf, &inobj); err != nil {"
            - "\t\treturn err"
            - "\t}"
            - ""
            - "\tobj.AuthData = (inobj.AuthData)"
            - "\tobj.Provider = (inobj.Provider)"
            - "\tobj.Username = (inobj.Username)"
            - "\treturn nil"
            - '}'
            - ""
            - type AuthResponse struct {
            - "\tFailure *rpc_root.Failure `json:\"failure\" yaml:\"failure\" db:\"failure\"`"
            - "\tUser    *User             `json:\"user\" yaml:\"user\" db:\"user\"`"
            - '}'
            - ""
            - func (obj *AuthResponse) MarshalJSON() ([]byte, error) {
            - "\toutobj := struct {"
            - "\t\tFailure *rpc_root.Failure `json:\"failure\"`"
            - "\t\tUser    *User             `json:\"user\"`"
            - "\t}{"
            - "\t\tFailure: (obj.Failure),"
            - "\t\tUser:    (obj.User),"
            - "\t}"
            - "\treturn json.Marshal(outobj)"
            - '}'
            - ""
            - func (obj *AuthResponse) UnmarshalJSON(buf []byte) error {
            - "\tinobj := struct {"
            - "\t\tFailure *rpc_root.Failure `json:\"failure\"`"
            - "\t\tUser    *User             `json:\"user\"`"
            - "\t}{}"
            - ""
            - "\tif err := json.Unmarshal(buf, &inobj); err != nil {"
            - "\t\treturn err"
            - "\t}"
            - ""
            - "\tobj.Failure = (inobj.Failure)"
            - "\tobj.User = (inobj.User)"
            - "\treturn nil"
            - '}'
            - ""
            - type User struct {
            - "\tEmail    string            `json:\"email\" yaml:\"email\" db:\"email\"`"
            - "\tMetadata map[string]string `json:\"metadata\" yaml:\"metadata\" db:\"metadata\"`"
            - "\tUsername string            `json:\"username\" yaml:\"username\" db:\"username\"`"
            - '}'
            - ""
            - func (obj *User) MarshalJSON() ([]byte, error) {
            - "\toutobj := struct {"
            - "\t\tEmail    string            `json:\"email\"`"
            - "\t\tMetadata map[string]string `json:\"metadata\"`"
            - "\t\tUsername string            `json:\"username\"`"
            - "\t}{"
            - "\t\tEmail:    (obj.Email),"
            - "\t\tMetadata: (obj.Metadata),"
            - "\t\tUsername: (obj.Username),"
            - "\t}"
            - "\treturn json.Marshal(outobj)"
            - '}'
            - ""
            - func (obj *User) UnmarshalJSON(buf []byte) error {
            - "\tinobj := struct {"
            - "\t\tEmail    string            `json:\"email\"`"
            - "\t\tMetadata map[string]string `json:\"metadata\"`"
            - "\t\tUsername string            `json:\"username\"`"
            - "\t}{}"
            - ""
            - "\tif err := json.Unmarshal(buf, &inobj); err != nil {"
            - "\t\treturn err"
            - "\t}"
            - ""
            - "\tobj.Email = (inobj.Email)"
            - "\tobj.Metadata = (inobj.Metadata)"
            - "\tobj.Username = (inobj.Username)"
            - "\treturn nil"
            - '}'
            - ""
            - type Interface interface {
            - '}'
            - // <auto-generated />
            - //
            - '// expected import: github.com/chakrit/rpc/examples/system'
            - package system
            - ""
            - import (
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"math\""
            - ""
            - "\trpc_root \"github.com/chakrit/rpc/examples\""
            - )
            - ""
            - var (
            - "\t_ context.Context = nil"
            - "\t_                 = json.Marshal"
            - "\t_                 = math.Pi"
            - )
            - ""
            - type Interface interface {
            - "\tStatus(context.Context) (*rpc_root.Failure, error,"
            - "\t)"
            - '}'
            - // <auto-generated />
            - //
            - '// expected import: github.com/chakrit/rpc/examples'
            - package examples
            - ""
            - import (
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"math\""
            - )
            - ""
            - var (
            - "\t_ context.Context = nil"
            - "\t_                 = json.Marshal"
            - "\t_                 = math.Pi"
            - )
            - ""
            - type Failure struct {
            - "\tCode        string `json:\"code\" yaml:\"code\" db:\"code\"`"
            - "\tDescription string `json:\"description\" yaml:\"description\" db:\"description\"`"
            - '}'
            - ""
            - func (obj *Failure) MarshalJSON() ([]byte, error) {
            - "\toutobj := struct {"
            - "\t\tCode        string `json:\"code\"`"
            - "\t\tDescription string `json:\"description\"`"
            - "\t}{"
            - "\t\tCode:        (obj.Code),"
            - "\t\tDescription: (obj.Description),"
            - "\t}"
            - "\treturn json.Marshal(outobj)"
            - '}'
            - ""
            - func (obj *Failure) UnmarshalJSON(buf []byte) error {
            - "\tinobj := struct {"
            - "\t\tCode        string `json:\"code\"`"
            - "\t\tDescription string `json:\"description\"`"
            - "\t}{}"
            - ""
            - "\tif err := json.Unmarshal(buf, &inobj); err != nil {"
            - "\t\treturn err"
            - "\t}"
            - ""
            - "\tobj.Code = (inobj.Code)"
            - "\tobj.Description = (inobj.Description)"
            - "\treturn nil"
            - '}'
            - ""
            - type Interface interface {
            - '}'
            - // <auto-generated />
            - //
            - '// expected import: github.com/chakrit/rpc/examples/todos'
            - package todos
            - ""
            - import (
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"math\""
            - ""
            - "\ttime \"time\""
            - )
            - ""
            - var (
            - "\t_ context.Context = nil"
            - "\t_                 = json.Marshal"
            - "\t_                 = math.Pi"
            - )
            - ""
            - type Item struct {
            - "\tAssignee    string    `json:\"assignee\" yaml:\"assignee\" db:\"assignee\"`"
            - "\tAuthor      string    `json:\"author\" yaml:\"author\" db:\"author\"`"
            - "\tCategory    string    `json:\"category\" yaml:\"category\" db:\"category\"`"
            - "\tCompleted   bool      `json:\"completed\" yaml:\"completed\" db:\"completed\"`"
            - "\tCtime       time.Time `json:\"ctime\" yaml:\"ctime\" db:\"ctime\"`"
            - "\tDescription string    `json:\"description\" yaml:\"description\"
              db:\"description\"`"
            - "\tDueDate     time.Time `json:\"dueDate\" yaml:\"dueDate\" db:\"due_date\"`"
            - "\tID          string    `json:\"id\" yaml:\"id\" db:\"id\"`"
            - "\tTags        []string  `json:\"tags\" yaml:\"tags\" db:\"tags\"`"
            - '}'
            - ""
            - func (obj *Item) MarshalJSON() ([]byte, error) {
            - "\toutobj := struct {"
            - "\t\tAssignee    string   `json:\"assignee\"`"
            - "\t\tAuthor      string   `json:\"author\"`"
            - "\t\tCategory    string   `json:\"category\"`"
            - "\t\tCompleted   bool     `json:\"completed\"`"
            - "\t\tCtime       float64  `json:\"ctime\"`"
            - "\t\tDescription string   `json:\"description\"`"
            - "\t\tDueDate     float64  `json:\"dueDate\"`"
            - "\t\tID          string   `json:\"id\"`"
            - "\t\tTags        []string `json:\"tags\"`"
            - "\t}{"
            - "\t\tAssignee:  (obj.Assignee),"
            - "\t\tAuthor:    (obj.Author),"
            - "\t\tCategory:  (obj.Category),"
            - "\t\tCompleted: (obj.Completed),"
            - "\t\tCtime: (func(t time.Time) float64 {"
            - "\t\t\tsec, nsec := t.Unix(), t.Nanosecond()"
            - "\t\t\treturn float64(sec) + (float64(nsec) / float64(time.Second))"
            - "\t\t})(obj.Ctime),"
            - "\t\tDescription: (obj.Description),"
            - "\t\tDueDate: (func(t time.Time) float64 {"
            - "\t\t\tsec, nsec := t.Unix(), t.Nanosecond()"
            - "\t\t\treturn float64(sec) + (float64(nsec) / float64(time.Second))"
            - "\t\t})(obj.DueDate),"
            - "\t\tID:   (obj.ID),"
            - "\t\tTags: (obj.Tags),"
            - "\t}"
            - "\treturn json.Marshal(outobj)"
            - '}'
            - ""
            - func (obj *Item) UnmarshalJSON(buf []byte) error {
            - "\tinobj := struct {"
            - "\t\tAssignee    string   `json:\"assignee\"`"
            - "\t\tAuthor      string   `json:\"author\"`"
            - "\t\tCategory    string   `json:\"category\"`"
            - "\t\tCompleted   bool     `json:\"completed\"`"
            - "\t\tCtime       float64  `json:\"ctime\"`"
            - "\t\tDescription string   `json:\"description\"`"
            - "\t\tDueDate     float64  `json:\"dueDate\"`"
            - "\t\tID          string   `json:\"id\"`"
            - "\t\tTags        []string `json:\"tags\"`"
            - "\t}{}"
            - ""
            - "\tif err := json.Unmarshal(buf, &inobj); err != nil {"
            - "\t\treturn err"
            - "\t}"
            - ""
            - "\tobj.Assignee = (inobj.Assignee)"
            - "\tobj.Author = (inobj.Author)"
            - "\tobj.Category = (inobj.Category)"
            - "\tobj.Completed = (inobj.Completed)"
            - "\tobj.Ctime = (func(t float64) time.Time {"
            - "\t\tfsec, fnsec := math.Modf(t)"
            - "\t\tsec, nsec := int64(fsec), int64(math.Round(fnsec*float64(time.Second)))"
            - "\t\treturn time.Unix(sec, nsec)"
            - "\t})(inobj.Ctime)"
            - "\tobj.Description = (inobj.Description)"
            - "\tobj.DueDate = (func(t float64) time.Time {"
            - "\t\tfsec, fnsec := math.Modf(t)"
            - "\t\tsec, nsec := int64(fsec), int64(math.Round(fnsec*float64(time.Second)))"
            - "\t\treturn time.Unix(sec, nsec)"
            - "\t})(inobj.DueDate)"
            - "\tobj.ID = (inobj.ID)"
            - "\tobj.Tags = (inobj.Tags)"
            - "\treturn nil"
            - '}'
            - ""
            - type Interface interface {
            - "\tDelete(context.Context, string) (*Item, error,"
            - "\t)"
            - "\tGet(context.Context, string) (*Item, error,"
            - "\t)"
            - "\tList(context.Context) ([]*Item, error,"
            - "\t)"
            - "\tPut(context.Context, string) (*Item, error,"
            - "\t)"
            - '}'
            - // <auto-generated />
            - //
            - '// expected import: github.com/chakrit/rpc/examples/client'
            - package client
            - ""
            - import (
            - "\t\"bytes\""
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"net/http\""
            - "\t\"time\""
            - ""
            - "\trpc_root \"github.com/chakrit/rpc/examples\""
            - "\trpc_system \"github.com/chakrit/rpc/examples/system\""
            - "\trpc_system_auth \"github.com/chakrit/rpc/examples/system/auth\""
            - ""
            - "\trpc_todos \"github.com/chakrit/rpc/examples/todos\""
            - )
            - ""
            - var (
            - "\t_ context.Context = nil"
            - "\t_ time.Time       = time.Time{}"
            - )
            - ""
            - // github.com/chakrit/rpc/examples
            - var _ rpc_root.Interface = Client_rpc_root{}
            - ""
            - type Client_rpc_root struct {
            - "\t*Client"
            - "\tSystem Client_rpc_system"
            - "\tTodos  Client_rpc_todos"
            - '}'
            - ""
            - func (c *Client_rpc_root) initialize(client *Client) {
            - "\tc.Client = client"
            - "\tc.System = Client_rpc_system{}"
            - "\tc.System.initialize(client)"
            - "\tc.Todos = Client_rpc_todos{}"
            - "\tc.Todos.initialize(client)"
            - '}'
            - ""
            - // github.com/chakrit/rpc/examples/system
            - var _ rpc_system.Interface = Client_rpc_system{}
            - ""
            - type Client_rpc_system struct {
            - "\t*Client"
            - "\tAuth Client_rpc_system_auth"
            - '}'
            - ""
            - func (c *Client_rpc_system) initialize(client *Client) {
            - "\tc.Client = client"
            - "\tc.Auth = Client_rpc_system_auth{}"
            - "\tc.Auth.initialize(client)"
            - '}'
            - ""
            - func (c Client_rpc_system) Status(
            - "\tctx context.Context,"
            - ) (
            - "\tout0 *rpc_root.Failure,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/examples/system/Status\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - // github.com/chakrit/rpc/examples/system/auth
            - var _ rpc_system_auth.Interface = Client_rpc_system_auth{}
            - ""
            - type Client_rpc_system_auth struct {
            - "\t*Client"
            - '}'
            - ""
            - func (c *Client_rpc_system_auth) initialize(client *Client) {
            - "\tc.Client = client"
            - '}'
            - ""
            - // github.com/chakrit/rpc/examples/todos
            - var _ rpc_todos.Interface = Client_rpc_todos{}
            - ""
            - type Client_rpc_todos struct {
            - "\t*Client"
            - '}'
            - ""
            - func (c *Client_rpc_todos) initialize(client *Client) {
            - "\tc.Client = client"
            - '}'
            - ""
            - func (c Client_rpc_todos) Delete(
            - "\tctx context.Context,"
            - "\targ0 string,"
            - ) (
            - "\tout0 *rpc_todos.Item,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{arg0}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/examples/todos/Delete\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - func (c Client_rpc_todos) Get(
            - "\tctx context.Context,"
            - "\targ0 string,"
            - ) (
            - "\tout0 *rpc_todos.Item,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{arg0}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/examples/todos/Get\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - func (c Client_rpc_todos) List(
            - "\tctx context.Context,"
            - ) (
            - "\tout0 []*rpc_todos.Item,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/examples/todos/List\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - func (c Client_rpc_todos) Put(
            - "\tctx context.Context,"
            - "\targ0 string,"
            - ) (
            - "\tout0 *rpc_todos.Item,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{arg0}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/examples/todos/Put\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - type Result struct {
            - "\tError   error         `json:\"error\"`"
            - "\tReturns []interface{} `json:\"returns\"`"
            - '}'
            - ""
            - type Client struct {
            - "\tOptions"
            - "\tClient_rpc_root"
            - ""
            - "\tHTTPClient *http.Client"
            - '}'
            - ""
            - type Options struct {
            - "\tAddr string"
            - '}'
            - ""
            - func New(opts *Options) *Client {
            - "\tclient := &Client{"
            - "\t\tOptions:         *opts,"
            - "\t\tClient_rpc_root: Client_rpc_root{},"
            - "\t\tHTTPClient:      &http.Client{},"
            - "\t}"
            - "\tclient.Client_rpc_root.initialize(client)"
            - "\treturn client"
            - '}'
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Generators \ Go \ Types
  commands:
    - command: rm -r /tmp/rpc >/dev/null 2>&1 || true
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -gen go -out /tmp/rpc/go all-types.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/go -name "*.go"
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - /tmp/rpc/go/server/server.go
            - /tmp/rpc/go/rpc.go
            - /tmp/rpc/go/client/client.go
        - name: stderr
          data:
            - ""
    - command: find /tmp/rpc/go -name "*.go" | xargs cat
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - // <auto-generated />
            - //
            - '// expected import: go.example.com/rpc/server'
            - package server
            - ""
            - import (
            - "\t\"bytes\""
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"io\""
            - "\t\"net/http\""
            - ""
            - "\trpc_root \"go.example.com/rpc\""
            - )
            - ""
            - type Handler_rpc_root struct {
            - "\tHandler rpc_root.Interface"
            - '}'
            - ""
            - type Result struct {
            - "\tError   error         `json:\"error\"`"
            - "\tReturns []interface{} `json:\"returns\"`"
            - '}'
            - ""
            - type Server struct {
            - "\toptions Options"
            - "\tHandler_rpc_root"
            - '}'
            - ""
            - type Options struct {
            - "\tAddr      string"
            - "\tCtxFilter func(req *http.Request, method string) context.Context"
            - "\tErrFilter func(req *http.Request, method string, err error) error"
            - "\tErrLog    func(req *http.Request, method string, err error)"
            - '}'
            - ""
            - func New(opts *Options) *Server {
            - "\tsrv := &Server{options: *opts}"
            - "\tif srv.options.CtxFilter == nil {"
            - "\t\tsrv.options.CtxFilter = func(req *http.Request, _ string) context.Context
              {"
            - "\t\t\treturn req.Context()"
            - "\t\t}"
            - "\t}"
            - "\tif srv.options.ErrFilter == nil {"
            - "\t\tsrv.options.ErrFilter = func(_ *http.Request, _ string, err error)
              error {"
            - "\t\t\treturn err"
            - "\t\t}"
            - "\t}"
            - "\treturn srv"
            - '}'
            - ""
            - func (s *Server) Listen() error {
            - "\treturn http.ListenAndServe(s.options.Addr, s.HTTPHandler())"
            - '}'
            - ""
            - func (s *Server) HTTPHandler() http.Handler {
            - "\tmux := http.NewServeMux()"
            - "\ts.register_rpc_root(mux, s.Handler_rpc_root)"
            - "\treturn mux"
            - '}'
            - ""
            - func (s *Server) register_rpc_root(
            - "\tmux *http.ServeMux,"
            - "\thandler Handler_rpc_root,"
            - ) *http.ServeMux {
            - ""
            - "\tmux.HandleFunc(\"/rpc/AllThe\", func(resp http.ResponseWriter, req
              *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"rpc/AllThe\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar arg0 *rpc_root.Things"
            - "\t\targs := [1]interface{}{"
            - "\t\t\t&arg0,"
            - "\t\t}"
            - ""
            - "\t\tif req.Body != nil {"
            - "\t\t\tif err := json.NewDecoder(req.Body).Decode(&args); err != nil
              {"
            - "\t\t\t\tresp.WriteHeader(400)"
            - "\t\t\t\trenderError(resp, err)"
            - "\t\t\t\treturn"
            - "\t\t\t}"
            - "\t\t}"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 *rpc_root.Things"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.AllThe("
            - "\t\t\tctx, arg0)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"rpc/AllThe\", err)"
            - "\t\t\ts.options.ErrLog(req, \"rpc/AllThe\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\tmux.HandleFunc(\"/rpc/CatIn\", func(resp http.ResponseWriter, req
              *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"rpc/CatIn\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar arg0 *rpc_root.Containers"
            - "\t\targs := [1]interface{}{"
            - "\t\t\t&arg0,"
            - "\t\t}"
            - ""
            - "\t\tif req.Body != nil {"
            - "\t\t\tif err := json.NewDecoder(req.Body).Decode(&args); err != nil
              {"
            - "\t\t\t\tresp.WriteHeader(400)"
            - "\t\t\t\trenderError(resp, err)"
            - "\t\t\t\treturn"
            - "\t\t\t}"
            - "\t\t}"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 *rpc_root.Containers"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.CatIn("
            - "\t\t\tctx, arg0)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"rpc/CatIn\", err)"
            - "\t\t\ts.options.ErrLog(req, \"rpc/CatIn\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\tmux.HandleFunc(\"/rpc/MixEmUp\", func(resp http.ResponseWriter, req
              *http.Request) {"
            - "\t\tvar ("
            - "\t\t\terr error"
            - "\t\t\tctx context.Context"
            - "\t\t)"
            - ""
            - "\t\tctx = s.options.CtxFilter(req, \"rpc/MixEmUp\")"
            - "\t\treq = req.WithContext(ctx)"
            - ""
            - "\t\tresp.Header().Set(\"Content-Type\", \"application/json\")"
            - ""
            - "\t\tvar arg0 *rpc_root.Things"
            - "\t\tvar arg1 *rpc_root.Containers"
            - "\t\tvar arg2 []*rpc_root.Things"
            - "\t\targs := [3]interface{}{"
            - "\t\t\t&arg0,"
            - "\t\t\t&arg1,"
            - "\t\t\t&arg2,"
            - "\t\t}"
            - ""
            - "\t\tif req.Body != nil {"
            - "\t\t\tif err := json.NewDecoder(req.Body).Decode(&args); err != nil
              {"
            - "\t\t\t\tresp.WriteHeader(400)"
            - "\t\t\t\trenderError(resp, err)"
            - "\t\t\t\treturn"
            - "\t\t\t}"
            - "\t\t}"
            - ""
            - "\t\tvar ("
            - "\t\t\tout0 interface{}"
            - "\t\t)"
            - ""
            - "\t\tout0, err = handler.Handler.MixEmUp("
            - "\t\t\tctx, arg0, arg1, arg2)"
            - ""
            - "\t\tif err != nil {"
            - "\t\t\terr = s.options.ErrFilter(req, \"rpc/MixEmUp\", err)"
            - "\t\t\ts.options.ErrLog(req, \"rpc/MixEmUp\", err)"
            - "\t\t}"
            - ""
            - "\t\tresult := &Result{"
            - "\t\t\tError: err,"
            - "\t\t\tReturns: []interface{}{"
            - "\t\t\t\tout0,"
            - "\t\t\t},"
            - "\t\t}"
            - ""
            - "\t\tif buf, err := json.Marshal(result); err != nil {"
            - "\t\t\tresp.WriteHeader(500)"
            - "\t\t\trenderError(resp, err)"
            - "\t\t} else {"
            - "\t\t\tresp.WriteHeader(200)"
            - "\t\t\t_, _ = io.Copy(resp, bytes.NewBuffer(buf))"
            - "\t\t}"
            - "\t})"
            - ""
            - "\treturn mux"
            - '}'
            - ""
            - func renderError(resp http.ResponseWriter, e error) {
            - "\tresult := &Result{"
            - "\t\tError:   e,"
            - "\t\tReturns: nil,"
            - "\t}"
            - ""
            - "\tbytes, err := json.Marshal(result)"
            - "\tif err != nil {"
            - "\t\t_, _ = resp.Write([]byte(`{\"error\":\"json processing error\"}`))"
            - "\t} else {"
            - "\t\t_, _ = resp.Write(bytes)"
            - "\t}"
            - '}'
            - // <auto-generated />
            - //
            - '// expected import: go.example.com/rpc'
            - package rpc
            - ""
            - import (
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"math\""
            - ""
            - "\ttime \"time\""
            - )
            - ""
            - var (
            - "\t_ context.Context = nil"
            - "\t_                 = json.Marshal"
            - "\t_                 = math.Pi"
            - )
            - ""
            - type Containers struct {
            - "\tEllijList        []int                `json:\"ellijList\" yaml:\"ellijList\"
              db:\"ellij_list\"`"
            - "\tEllijMap         map[string]int       `json:\"ellijMap\" yaml:\"ellijMap\"
              db:\"ellij_map\"`"
            - "\tEspressoList     []float64            `json:\"espressoList\" yaml:\"espressoList\"
              db:\"espresso_list\"`"
            - "\tEspressoMap      map[string]float64   `json:\"espressoMap\" yaml:\"espressoMap\"
              db:\"espresso_map\"`"
            - "\tIngCastleList    []float32            `json:\"ingCastleList\" yaml:\"ingCastleList\"
              db:\"ing_castle_list\"`"
            - "\tIngCastleMap     map[string]float32   `json:\"ingCastleMap\" yaml:\"ingCastleMap\"
              db:\"ing_castle_map\"`"
            - "\tIslandList       []int64              `json:\"islandList\" yaml:\"islandList\"
              db:\"island_list\"`"
            - "\tIslandMap        map[string]int64     `json:\"islandMap\" yaml:\"islandMap\"
              db:\"island_map\"`"
            - "\tOfCharactersList []string             `json:\"ofCharactersList\"
              yaml:\"ofCharactersList\" db:\"of_characters_list\"`"
            - "\tOfCharactersMap  map[string]string    `json:\"ofCharactersMap\" yaml:\"ofCharactersMap\"
              db:\"of_characters_map\"`"
            - "\tSoongTypeList    [][]byte             `json:\"soongTypeList\" yaml:\"soongTypeList\"
              db:\"soong_type_list\"`"
            - "\tSoongTypeMap     map[string][]byte    `json:\"soongTypeMap\" yaml:\"soongTypeMap\"
              db:\"soong_type_map\"`"
            - "\tTravellingList   []time.Time          `json:\"travellingList\" yaml:\"travellingList\"
              db:\"travelling_list\"`"
            - "\tTravellingMap    map[string]time.Time `json:\"travellingMap\" yaml:\"travellingMap\"
              db:\"travelling_map\"`"
            - "\tTruthOrDareList  []bool               `json:\"truthOrDareList\" yaml:\"truthOrDareList\"
              db:\"truth_or_dare_list\"`"
            - "\tTruthOrDareMap   map[string]bool      `json:\"truthOrDareMap\" yaml:\"truthOrDareMap\"
              db:\"truth_or_dare_map\"`"
            - '}'
            - ""
            - func (obj *Containers) MarshalJSON() ([]byte, error) {
            - "\toutobj := struct {"
            - "\t\tEllijList        []int                `json:\"ellijList\"`"
            - "\t\tEllijMap         map[string]int       `json:\"ellijMap\"`"
            - "\t\tEspressoList     []float64            `json:\"espressoList\"`"
            - "\t\tEspressoMap      map[string]float64   `json:\"espressoMap\"`"
            - "\t\tIngCastleList    []float32            `json:\"ingCastleList\"`"
            - "\t\tIngCastleMap     map[string]float32   `json:\"ingCastleMap\"`"
            - "\t\tIslandList       []int64              `json:\"islandList\"`"
            - "\t\tIslandMap        map[string]int64     `json:\"islandMap\"`"
            - "\t\tOfCharactersList []string             `json:\"ofCharactersList\"`"
            - "\t\tOfCharactersMap  map[string]string    `json:\"ofCharactersMap\"`"
            - "\t\tSoongTypeList    [][]byte             `json:\"soongTypeList\"`"
            - "\t\tSoongTypeMap     map[string][]byte    `json:\"soongTypeMap\"`"
            - "\t\tTravellingList   []time.Time          `json:\"travellingList\"`"
            - "\t\tTravellingMap    map[string]time.Time `json:\"travellingMap\"`"
            - "\t\tTruthOrDareList  []bool               `json:\"truthOrDareList\"`"
            - "\t\tTruthOrDareMap   map[string]bool      `json:\"truthOrDareMap\"`"
            - "\t}{"
            - "\t\tEllijList:        (obj.EllijList),"
            - "\t\tEllijMap:         (obj.EllijMap),"
            - "\t\tEspressoList:     (obj.EspressoList),"
            - "\t\tEspressoMap:      (obj.EspressoMap),"
            - "\t\tIngCastleList:    (obj.IngCastleList),"
            - "\t\tIngCastleMap:     (obj.IngCastleMap),"
            - "\t\tIslandList:       (obj.IslandList),"
            - "\t\tIslandMap:        (obj.IslandMap),"
            - "\t\tOfCharactersList: (obj.OfCharactersList),"
            - "\t\tOfCharactersMap:  (obj.OfCharactersMap),"
            - "\t\tSoongTypeList:    (obj.SoongTypeList),"
            - "\t\tSoongTypeMap:     (obj.SoongTypeMap),"
            - "\t\tTravellingList:   (obj.TravellingList),"
            - "\t\tTravellingMap:    (obj.TravellingMap),"
            - "\t\tTruthOrDareList:  (obj.TruthOrDareList),"
            - "\t\tTruthOrDareMap:   (obj.TruthOrDareMap),"
            - "\t}"
            - "\treturn json.Marshal(outobj)"
            - '}'
            - ""
            - func (obj *Containers) UnmarshalJSON(buf []byte) error {
            - "\tinobj := struct {"
            - "\t\tEllijList        []int                `json:\"ellijList\"`"
            - "\t\tEllijMap         map[string]int       `json:\"ellijMap\"`"
            - "\t\tEspressoList     []float64            `json:\"espressoList\"`"
            - "\t\tEspressoMap      map[string]float64   `json:\"espressoMap\"`"
            - "\t\tIngCastleList    []float32            `json:\"ingCastleList\"`"
            - "\t\tIngCastleMap     map[string]float32   `json:\"ingCastleMap\"`"
            - "\t\tIslandList       []int64              `json:\"islandList\"`"
            - "\t\tIslandMap        map[string]int64     `json:\"islandMap\"`"
            - "\t\tOfCharactersList []string             `json:\"ofCharactersList\"`"
            - "\t\tOfCharactersMap  map[string]string    `json:\"ofCharactersMap\"`"
            - "\t\tSoongTypeList    [][]byte             `json:\"soongTypeList\"`"
            - "\t\tSoongTypeMap     map[string][]byte    `json:\"soongTypeMap\"`"
            - "\t\tTravellingList   []time.Time          `json:\"travellingList\"`"
            - "\t\tTravellingMap    map[string]time.Time `json:\"travellingMap\"`"
            - "\t\tTruthOrDareList  []bool               `json:\"truthOrDareList\"`"
            - "\t\tTruthOrDareMap   map[string]bool      `json:\"truthOrDareMap\"`"
            - "\t}{}"
            - ""
            - "\tif err := json.Unmarshal(buf, &inobj); err != nil {"
            - "\t\treturn err"
            - "\t}"
            - ""
            - "\tobj.EllijList = (inobj.EllijList)"
            - "\tobj.EllijMap = (inobj.EllijMap)"
            - "\tobj.EspressoList = (inobj.EspressoList)"
            - "\tobj.EspressoMap = (inobj.EspressoMap)"
            - "\tobj.IngCastleList = (inobj.IngCastleList)"
            - "\tobj.IngCastleMap = (inobj.IngCastleMap)"
            - "\tobj.IslandList = (inobj.IslandList)"
            - "\tobj.IslandMap = (inobj.IslandMap)"
            - "\tobj.OfCharactersList = (inobj.OfCharactersList)"
            - "\tobj.OfCharactersMap = (inobj.OfCharactersMap)"
            - "\tobj.SoongTypeList = (inobj.SoongTypeList)"
            - "\tobj.SoongTypeMap = (inobj.SoongTypeMap)"
            - "\tobj.TravellingList = (inobj.TravellingList)"
            - "\tobj.TravellingMap = (inobj.TravellingMap)"
            - "\tobj.TruthOrDareList = (inobj.TruthOrDareList)"
            - "\tobj.TruthOrDareMap = (inobj.TruthOrDareMap)"
            - "\treturn nil"
            - '}'
            - ""
            - type Things struct {
            - "\tEllij        int       `json:\"ellij\" yaml:\"ellij\" db:\"ellij\"`"
            - "\tEspresso     float64   `json:\"espresso\" yaml:\"espresso\" db:\"espresso\"`"
            - "\tIngCastle    float32   `json:\"ingCastle\" yaml:\"ingCastle\" db:\"ing_castle\"`"
            - "\tIsland       int64     `json:\"island\" yaml:\"island\" db:\"island\"`"
            - "\tOfCharacters string    `json:\"ofCharacters\" yaml:\"ofCharacters\"
              db:\"of_characters\"`"
            - "\tSoongType    []byte    `json:\"soongType\" yaml:\"soongType\" db:\"soong_type\"`"
            - "\tTravelling   time.Time `json:\"travelling\" yaml:\"travelling\" db:\"travelling\"`"
            - "\tTruthOrDare  bool      `json:\"truthOrDare\" yaml:\"truthOrDare\"
              db:\"truth_or_dare\"`"
            - '}'
            - ""
            - func (obj *Things) MarshalJSON() ([]byte, error) {
            - "\toutobj := struct {"
            - "\t\tEllij        int     `json:\"ellij\"`"
            - "\t\tEspresso     float64 `json:\"espresso\"`"
            - "\t\tIngCastle    float32 `json:\"ingCastle\"`"
            - "\t\tIsland       int64   `json:\"island\"`"
            - "\t\tOfCharacters string  `json:\"ofCharacters\"`"
            - "\t\tSoongType    []byte  `json:\"soongType\"`"
            - "\t\tTravelling   float64 `json:\"travelling\"`"
            - "\t\tTruthOrDare  bool    `json:\"truthOrDare\"`"
            - "\t}{"
            - "\t\tEllij:        (obj.Ellij),"
            - "\t\tEspresso:     (obj.Espresso),"
            - "\t\tIngCastle:    (obj.IngCastle),"
            - "\t\tIsland:       (obj.Island),"
            - "\t\tOfCharacters: (obj.OfCharacters),"
            - "\t\tSoongType:    (obj.SoongType),"
            - "\t\tTravelling: (func(t time.Time) float64 {"
            - "\t\t\tsec, nsec := t.Unix(), t.Nanosecond()"
            - "\t\t\treturn float64(sec) + (float64(nsec) / float64(time.Second))"
            - "\t\t})(obj.Travelling),"
            - "\t\tTruthOrDare: (obj.TruthOrDare),"
            - "\t}"
            - "\treturn json.Marshal(outobj)"
            - '}'
            - ""
            - func (obj *Things) UnmarshalJSON(buf []byte) error {
            - "\tinobj := struct {"
            - "\t\tEllij        int     `json:\"ellij\"`"
            - "\t\tEspresso     float64 `json:\"espresso\"`"
            - "\t\tIngCastle    float32 `json:\"ingCastle\"`"
            - "\t\tIsland       int64   `json:\"island\"`"
            - "\t\tOfCharacters string  `json:\"ofCharacters\"`"
            - "\t\tSoongType    []byte  `json:\"soongType\"`"
            - "\t\tTravelling   float64 `json:\"travelling\"`"
            - "\t\tTruthOrDare  bool    `json:\"truthOrDare\"`"
            - "\t}{}"
            - ""
            - "\tif err := json.Unmarshal(buf, &inobj); err != nil {"
            - "\t\treturn err"
            - "\t}"
            - ""
            - "\tobj.Ellij = (inobj.Ellij)"
            - "\tobj.Espresso = (inobj.Espresso)"
            - "\tobj.IngCastle = (inobj.IngCastle)"
            - "\tobj.Island = (inobj.Island)"
            - "\tobj.OfCharacters = (inobj.OfCharacters)"
            - "\tobj.SoongType = (inobj.SoongType)"
            - "\tobj.Travelling = (func(t float64) time.Time {"
            - "\t\tfsec, fnsec := math.Modf(t)"
            - "\t\tsec, nsec := int64(fsec), int64(math.Round(fnsec*float64(time.Second)))"
            - "\t\treturn time.Unix(sec, nsec)"
            - "\t})(inobj.Travelling)"
            - "\tobj.TruthOrDare = (inobj.TruthOrDare)"
            - "\treturn nil"
            - '}'
            - ""
            - type Interface interface {
            - "\tAllThe(context.Context, *Things) (*Things, error,"
            - "\t)"
            - "\tCatIn(context.Context, *Containers) (*Containers, error,"
            - "\t)"
            - "\tMixEmUp(context.Context, *Things, *Containers, []*Things) (interface{},
              error,"
            - "\t)"
            - '}'
            - // <auto-generated />
            - //
            - '// expected import: go.example.com/rpc/client'
            - package client
            - ""
            - import (
            - "\t\"bytes\""
            - "\t\"context\""
            - "\t\"encoding/json\""
            - "\t\"net/http\""
            - "\t\"time\""
            - ""
            - "\trpc_root \"go.example.com/rpc\""
            - )
            - ""
            - var (
            - "\t_ context.Context = nil"
            - "\t_ time.Time       = time.Time{}"
            - )
            - ""
            - // go.example.com/rpc
            - var _ rpc_root.Interface = Client_rpc_root{}
            - ""
            - type Client_rpc_root struct {
            - "\t*Client"
            - '}'
            - ""
            - func (c *Client_rpc_root) initialize(client *Client) {
            - "\tc.Client = client"
            - '}'
            - ""
            - func (c Client_rpc_root) AllThe(
            - "\tctx context.Context,"
            - "\targ0 *rpc_root.Things,"
            - ) (
            - "\tout0 *rpc_root.Things,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{arg0}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/rpc/AllThe\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - func (c Client_rpc_root) CatIn(
            - "\tctx context.Context,"
            - "\targ0 *rpc_root.Containers,"
            - ) (
            - "\tout0 *rpc_root.Containers,"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{arg0}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/rpc/CatIn\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - func (c Client_rpc_root) MixEmUp(
            - "\tctx context.Context,"
            - "\targ0 *rpc_root.Things,"
            - "\targ1 *rpc_root.Containers,"
            - "\targ2 []*rpc_root.Things,"
            - ) (
            - "\tout0 interface{},"
            - "\terr error,"
            - ) {
            - "\tpayload := []interface{}{arg0, arg1, arg2}"
            - ""
            - "\tbuf := &bytes.Buffer{}"
            - "\tif err = json.NewEncoder(buf).Encode(payload); err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\tvar req *http.Request"
            - "\treq, err = http.NewRequest(\"POST\", \"http://\"+c.Client.Options.Addr+\"/rpc/MixEmUp\",
              buf)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treq = req.WithContext(ctx)"
            - ""
            - "\tvar resp *http.Response"
            - "\tresp, err = c.HTTPClient.Do(req)"
            - "\tif err != nil {"
            - "\t\treturn"
            - "\t}"
            - ""
            - "\treturns := [1]interface{}{&out0}"
            - "\tresult := &Result{}"
            - "\tresult.Returns = returns[:]"
            - ""
            - "\tif resp.Body != nil {"
            - "\t\tdefer resp.Body.Close()"
            - ""
            - "\t\tif err = json.NewDecoder(resp.Body).Decode(result); err != nil
              {"
            - "\t\t\treturn"
            - "\t\t}"
            - "\t}"
            - ""
            - "\tif result.Error != nil {"
            - "\t\terr = result.Error"
            - "\t}"
            - "\treturn"
            - '}'
            - ""
            - type Result struct {
            - "\tError   error         `json:\"error\"`"
            - "\tReturns []interface{} `json:\"returns\"`"
            - '}'
            - ""
            - type Client struct {
            - "\tOptions"
            - "\tClient_rpc_root"
            - ""
            - "\tHTTPClient *http.Client"
            - '}'
            - ""
            - type Options struct {
            - "\tAddr string"
            - '}'
            - ""
            - func New(opts *Options) *Client {
            - "\tclient := &Client{"
            - "\t\tOptions:         *opts,"
            - "\t\tClient_rpc_root: Client_rpc_root{},"
            - "\t\tHTTPClient:      &http.Client{},"
            - "\t}"
            - "\tclient.Client_rpc_root.initialize(client)"
            - "\treturn client"
            - '}'
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Client<->Server \ Go
  commands:
    - command: go generate -v ./...
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - handler.go
            - main.go
            - api/rpc.go
            - api/client/client.go
            - api/server/server.go
    - command: go build -o ./bin/clientserver .
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: ./bin/clientserver
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - List
            - Update
            - '[alpha] alpha'
            - Update
            - '[beta] beta !DONE!'
            - List
            - '[alpha] alpha'
            - '[beta] beta !DONE!'
            - Destroy
            - '[alpha] alpha'
            - Destroy
            - '[beta] beta !DONE!'
            - List
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Examples \ todoapp
  commands:
    - command: ./build.sh
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - "[================                                  ] - 1 / 3\r[=================================
              \                ] - 2 / 3\r[==================================================]
              - 3 / 3\r                                                                     \rSuccess!
              Compiled 3 modules."
        - name: stderr
          data:
            - ""
