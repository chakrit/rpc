- name: ./smoketests.yml \ Basics
  commands:
    - command: go install -v ..
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Basics \ Lexing
  commands:
    - command: go install -v ..
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -lex todo-simple.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - '{"type":"keyword","value":"option","pos":{"byte_no":6,"line_no":0,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":7,"line_no":0,"col_no":7}}'
            - '{"type":"identifier","value":"transport","pos":{"byte_no":16,"line_no":0,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":17,"line_no":0,"col_no":17}}'
            - '{"type":"value-string","value":"http","pos":{"byte_no":23,"line_no":0,"col_no":23}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":24,"line_no":0,"col_no":24}}'
            - '{"type":"keyword","value":"option","pos":{"byte_no":30,"line_no":1,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":31,"line_no":1,"col_no":7}}'
            - '{"type":"identifier","value":"encoding","pos":{"byte_no":39,"line_no":1,"col_no":15}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":40,"line_no":1,"col_no":16}}'
            - '{"type":"value-string","value":"json","pos":{"byte_no":46,"line_no":1,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":47,"line_no":1,"col_no":23}}'
            - '{"type":"keyword","value":"option","pos":{"byte_no":53,"line_no":2,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":54,"line_no":2,"col_no":7}}'
            - '{"type":"identifier","value":"ruby_module","pos":{"byte_no":65,"line_no":2,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":66,"line_no":2,"col_no":19}}'
            - '{"type":"value-string","value":"minitodo","pos":{"byte_no":76,"line_no":2,"col_no":29}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":77,"line_no":2,"col_no":30}}'
            - '{"type":"keyword","value":"option","pos":{"byte_no":83,"line_no":3,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":84,"line_no":3,"col_no":7}}'
            - '{"type":"identifier","value":"go_package","pos":{"byte_no":94,"line_no":3,"col_no":17}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":95,"line_no":3,"col_no":18}}'
            - '{"type":"value-string","value":"minitodo","pos":{"byte_no":105,"line_no":3,"col_no":28}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":106,"line_no":3,"col_no":29}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":107,"line_no":4,"col_no":1}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":111,"line_no":5,"col_no":4}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":112,"line_no":5,"col_no":5}}'
            - '{"type":"identifier","value":"Failure","pos":{"byte_no":119,"line_no":5,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":120,"line_no":5,"col_no":13}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":121,"line_no":5,"col_no":14}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":122,"line_no":5,"col_no":15}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":126,"line_no":6,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":132,"line_no":6,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":133,"line_no":6,"col_no":11}}'
            - '{"type":"identifier","value":"code","pos":{"byte_no":137,"line_no":6,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":138,"line_no":6,"col_no":16}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":142,"line_no":7,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":148,"line_no":7,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":149,"line_no":7,"col_no":11}}'
            - '{"type":"identifier","value":"description","pos":{"byte_no":160,"line_no":7,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":161,"line_no":7,"col_no":23}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":162,"line_no":8,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":163,"line_no":8,"col_no":2}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":164,"line_no":9,"col_no":1}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":168,"line_no":10,"col_no":4}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":169,"line_no":10,"col_no":5}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":177,"line_no":10,"col_no":13}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":178,"line_no":10,"col_no":14}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":179,"line_no":10,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":180,"line_no":10,"col_no":16}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":184,"line_no":11,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":190,"line_no":11,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":191,"line_no":11,"col_no":11}}'
            - '{"type":"identifier","value":"uuid","pos":{"byte_no":195,"line_no":11,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":196,"line_no":11,"col_no":16}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":200,"line_no":12,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":206,"line_no":12,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":207,"line_no":12,"col_no":11}}'
            - '{"type":"identifier","value":"description","pos":{"byte_no":218,"line_no":12,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":219,"line_no":12,"col_no":23}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":223,"line_no":13,"col_no":4}}'
            - '{"type":"keyword","value":"time","pos":{"byte_no":227,"line_no":13,"col_no":8}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":228,"line_no":13,"col_no":9}}'
            - '{"type":"identifier","value":"ctime","pos":{"byte_no":233,"line_no":13,"col_no":14}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":234,"line_no":13,"col_no":15}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":238,"line_no":14,"col_no":4}}'
            - '{"type":"keyword","value":"bool","pos":{"byte_no":242,"line_no":14,"col_no":8}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":243,"line_no":14,"col_no":9}}'
            - '{"type":"identifier","value":"completed","pos":{"byte_no":252,"line_no":14,"col_no":18}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":253,"line_no":14,"col_no":19}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":254,"line_no":15,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":255,"line_no":15,"col_no":2}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":256,"line_no":16,"col_no":1}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":259,"line_no":17,"col_no":3}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":260,"line_no":17,"col_no":4}}'
            - '{"type":"identifier","value":"List","pos":{"byte_no":264,"line_no":17,"col_no":8}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":265,"line_no":17,"col_no":9}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":266,"line_no":17,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":267,"line_no":17,"col_no":11}}'
            - '{"type":"keyword","value":"list","pos":{"byte_no":271,"line_no":17,"col_no":15}}'
            - '{"type":"type-arg-list-start","value":"\u003c","pos":{"byte_no":272,"line_no":17,"col_no":16}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":280,"line_no":17,"col_no":24}}'
            - '{"type":"type-arg-list-end","value":"\u003e","pos":{"byte_no":281,"line_no":17,"col_no":25}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":282,"line_no":17,"col_no":26}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":285,"line_no":18,"col_no":3}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":286,"line_no":18,"col_no":4}}'
            - '{"type":"identifier","value":"Get","pos":{"byte_no":289,"line_no":18,"col_no":7}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":290,"line_no":18,"col_no":8}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":296,"line_no":18,"col_no":14}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":297,"line_no":18,"col_no":15}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":298,"line_no":18,"col_no":16}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":306,"line_no":18,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":307,"line_no":18,"col_no":25}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":310,"line_no":19,"col_no":3}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":311,"line_no":19,"col_no":4}}'
            - '{"type":"identifier","value":"Put","pos":{"byte_no":314,"line_no":19,"col_no":7}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":315,"line_no":19,"col_no":8}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":323,"line_no":19,"col_no":16}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":324,"line_no":19,"col_no":17}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":325,"line_no":19,"col_no":18}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":333,"line_no":19,"col_no":26}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":334,"line_no":19,"col_no":27}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":337,"line_no":20,"col_no":3}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":338,"line_no":20,"col_no":4}}'
            - '{"type":"identifier","value":"Delete","pos":{"byte_no":344,"line_no":20,"col_no":10}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":345,"line_no":20,"col_no":11}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":351,"line_no":20,"col_no":17}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":352,"line_no":20,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":353,"line_no":20,"col_no":19}}'
            - '{"type":"identifier","value":"TodoItem","pos":{"byte_no":361,"line_no":20,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":362,"line_no":20,"col_no":28}}'
            - '{"type":"end-of-file","value":"","pos":{"byte_no":362,"line_no":21,"col_no":0}}'
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -lex todo-complex.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - '{"type":"keyword","value":"option","pos":{"byte_no":6,"line_no":0,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":7,"line_no":0,"col_no":7}}'
            - '{"type":"identifier","value":"go_import","pos":{"byte_no":16,"line_no":0,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":17,"line_no":0,"col_no":17}}'
            - '{"type":"value-string","value":"github.com/chakrit/rpc/examples","pos":{"byte_no":50,"line_no":0,"col_no":50}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":51,"line_no":0,"col_no":51}}'
            - '{"type":"keyword","value":"option","pos":{"byte_no":57,"line_no":1,"col_no":6}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":58,"line_no":1,"col_no":7}}'
            - '{"type":"identifier","value":"go_package","pos":{"byte_no":68,"line_no":1,"col_no":17}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":69,"line_no":1,"col_no":18}}'
            - '{"type":"value-string","value":"examples","pos":{"byte_no":79,"line_no":1,"col_no":28}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":80,"line_no":1,"col_no":29}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":81,"line_no":2,"col_no":1}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":85,"line_no":3,"col_no":4}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":86,"line_no":3,"col_no":5}}'
            - '{"type":"identifier","value":"Failure","pos":{"byte_no":93,"line_no":3,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":94,"line_no":3,"col_no":13}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":95,"line_no":3,"col_no":14}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":96,"line_no":3,"col_no":15}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":100,"line_no":4,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":106,"line_no":4,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":107,"line_no":4,"col_no":11}}'
            - '{"type":"identifier","value":"code","pos":{"byte_no":111,"line_no":4,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":112,"line_no":4,"col_no":16}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":116,"line_no":5,"col_no":4}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":122,"line_no":5,"col_no":10}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":123,"line_no":5,"col_no":11}}'
            - '{"type":"identifier","value":"description","pos":{"byte_no":134,"line_no":5,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":135,"line_no":5,"col_no":23}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":136,"line_no":6,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":137,"line_no":6,"col_no":2}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":138,"line_no":7,"col_no":1}}'
            - '{"type":"keyword","value":"namespace","pos":{"byte_no":147,"line_no":8,"col_no":9}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":148,"line_no":8,"col_no":10}}'
            - '{"type":"identifier","value":"System","pos":{"byte_no":154,"line_no":8,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":155,"line_no":8,"col_no":17}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":156,"line_no":8,"col_no":18}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":157,"line_no":8,"col_no":19}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":161,"line_no":9,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":164,"line_no":9,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":165,"line_no":9,"col_no":8}}'
            - '{"type":"identifier","value":"Status","pos":{"byte_no":171,"line_no":9,"col_no":14}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":172,"line_no":9,"col_no":15}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":173,"line_no":9,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":174,"line_no":9,"col_no":17}}'
            - '{"type":"identifier","value":"Failure","pos":{"byte_no":181,"line_no":9,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":182,"line_no":9,"col_no":25}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":183,"line_no":10,"col_no":1}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":187,"line_no":11,"col_no":4}}'
            - '{"type":"keyword","value":"namespace","pos":{"byte_no":196,"line_no":11,"col_no":13}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":197,"line_no":11,"col_no":14}}'
            - '{"type":"identifier","value":"Auth","pos":{"byte_no":201,"line_no":11,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":202,"line_no":11,"col_no":19}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":203,"line_no":11,"col_no":20}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":204,"line_no":11,"col_no":21}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":212,"line_no":12,"col_no":8}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":216,"line_no":12,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":217,"line_no":12,"col_no":13}}'
            - '{"type":"identifier","value":"User","pos":{"byte_no":221,"line_no":12,"col_no":17}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":222,"line_no":12,"col_no":18}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":223,"line_no":12,"col_no":19}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":224,"line_no":12,"col_no":20}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":236,"line_no":13,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":242,"line_no":13,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":243,"line_no":13,"col_no":19}}'
            - '{"type":"identifier","value":"username","pos":{"byte_no":251,"line_no":13,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":252,"line_no":13,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":264,"line_no":14,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":270,"line_no":14,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":271,"line_no":14,"col_no":19}}'
            - '{"type":"identifier","value":"email","pos":{"byte_no":276,"line_no":14,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":277,"line_no":14,"col_no":25}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":289,"line_no":15,"col_no":12}}'
            - '{"type":"keyword","value":"map","pos":{"byte_no":292,"line_no":15,"col_no":15}}'
            - '{"type":"type-arg-list-start","value":"\u003c","pos":{"byte_no":293,"line_no":15,"col_no":16}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":299,"line_no":15,"col_no":22}}'
            - '{"type":"arg-list-sep","value":",","pos":{"byte_no":300,"line_no":15,"col_no":23}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":301,"line_no":15,"col_no":24}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":307,"line_no":15,"col_no":30}}'
            - '{"type":"type-arg-list-end","value":"\u003e","pos":{"byte_no":308,"line_no":15,"col_no":31}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":309,"line_no":15,"col_no":32}}'
            - '{"type":"identifier","value":"metadata","pos":{"byte_no":317,"line_no":15,"col_no":40}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":318,"line_no":15,"col_no":41}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":326,"line_no":16,"col_no":8}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":327,"line_no":16,"col_no":9}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":328,"line_no":16,"col_no":10}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":329,"line_no":17,"col_no":1}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":337,"line_no":18,"col_no":8}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":341,"line_no":18,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":342,"line_no":18,"col_no":13}}'
            - '{"type":"identifier","value":"AuthRequest","pos":{"byte_no":353,"line_no":18,"col_no":24}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":354,"line_no":18,"col_no":25}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":355,"line_no":18,"col_no":26}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":356,"line_no":18,"col_no":27}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":368,"line_no":19,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":374,"line_no":19,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":375,"line_no":19,"col_no":19}}'
            - '{"type":"identifier","value":"provider","pos":{"byte_no":383,"line_no":19,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":384,"line_no":19,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":396,"line_no":20,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":402,"line_no":20,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":403,"line_no":20,"col_no":19}}'
            - '{"type":"identifier","value":"username","pos":{"byte_no":411,"line_no":20,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":412,"line_no":20,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":424,"line_no":21,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":430,"line_no":21,"col_no":18}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":431,"line_no":21,"col_no":19}}'
            - '{"type":"identifier","value":"authData","pos":{"byte_no":439,"line_no":21,"col_no":27}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":440,"line_no":21,"col_no":28}}'
            - '{"type":"comment","value":"// change to bytes type","pos":{"byte_no":463,"line_no":21,"col_no":51}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":464,"line_no":21,"col_no":52}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":472,"line_no":22,"col_no":8}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":473,"line_no":22,"col_no":9}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":474,"line_no":22,"col_no":10}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":482,"line_no":23,"col_no":8}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":486,"line_no":23,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":487,"line_no":23,"col_no":13}}'
            - '{"type":"identifier","value":"AuthResponse","pos":{"byte_no":499,"line_no":23,"col_no":25}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":500,"line_no":23,"col_no":26}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":501,"line_no":23,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":502,"line_no":23,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":514,"line_no":24,"col_no":12}}'
            - '{"type":"identifier","value":"Failure","pos":{"byte_no":521,"line_no":24,"col_no":19}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":522,"line_no":24,"col_no":20}}'
            - '{"type":"identifier","value":"failure","pos":{"byte_no":529,"line_no":24,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":530,"line_no":24,"col_no":28}}'
            - '{"type":"whitespace","value":"            ","pos":{"byte_no":542,"line_no":25,"col_no":12}}'
            - '{"type":"identifier","value":"User","pos":{"byte_no":546,"line_no":25,"col_no":16}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":547,"line_no":25,"col_no":17}}'
            - '{"type":"identifier","value":"user","pos":{"byte_no":551,"line_no":25,"col_no":21}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":552,"line_no":25,"col_no":22}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":560,"line_no":26,"col_no":8}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":561,"line_no":26,"col_no":9}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":562,"line_no":26,"col_no":10}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":566,"line_no":27,"col_no":4}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":567,"line_no":27,"col_no":5}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":568,"line_no":27,"col_no":6}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":569,"line_no":28,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":570,"line_no":28,"col_no":2}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":571,"line_no":29,"col_no":1}}'
            - '{"type":"keyword","value":"namespace","pos":{"byte_no":580,"line_no":30,"col_no":9}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":581,"line_no":30,"col_no":10}}'
            - '{"type":"identifier","value":"Todos","pos":{"byte_no":586,"line_no":30,"col_no":15}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":587,"line_no":30,"col_no":16}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":588,"line_no":30,"col_no":17}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":589,"line_no":30,"col_no":18}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":593,"line_no":31,"col_no":4}}'
            - '{"type":"keyword","value":"type","pos":{"byte_no":597,"line_no":31,"col_no":8}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":598,"line_no":31,"col_no":9}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":602,"line_no":31,"col_no":13}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":603,"line_no":31,"col_no":14}}'
            - '{"type":"block-start","value":"{","pos":{"byte_no":604,"line_no":31,"col_no":15}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":605,"line_no":31,"col_no":16}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":613,"line_no":32,"col_no":8}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":619,"line_no":32,"col_no":14}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":620,"line_no":32,"col_no":15}}'
            - '{"type":"identifier","value":"id","pos":{"byte_no":622,"line_no":32,"col_no":17}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":623,"line_no":32,"col_no":18}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":631,"line_no":33,"col_no":8}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":637,"line_no":33,"col_no":14}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":638,"line_no":33,"col_no":15}}'
            - '{"type":"identifier","value":"description","pos":{"byte_no":649,"line_no":33,"col_no":26}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":650,"line_no":33,"col_no":27}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":658,"line_no":34,"col_no":8}}'
            - '{"type":"keyword","value":"time","pos":{"byte_no":662,"line_no":34,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":663,"line_no":34,"col_no":13}}'
            - '{"type":"identifier","value":"ctime","pos":{"byte_no":668,"line_no":34,"col_no":18}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":669,"line_no":34,"col_no":19}}'
            - '{"type":"whitespace","value":"        ","pos":{"byte_no":677,"line_no":35,"col_no":8}}'
            - '{"type":"keyword","value":"bool","pos":{"byte_no":681,"line_no":35,"col_no":12}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":682,"line_no":35,"col_no":13}}'
            - '{"type":"identifier","value":"completed","pos":{"byte_no":691,"line_no":35,"col_no":22}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":692,"line_no":35,"col_no":23}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":696,"line_no":36,"col_no":4}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":697,"line_no":36,"col_no":5}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":698,"line_no":36,"col_no":6}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":699,"line_no":37,"col_no":1}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":703,"line_no":38,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":706,"line_no":38,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":707,"line_no":38,"col_no":8}}'
            - '{"type":"identifier","value":"List","pos":{"byte_no":711,"line_no":38,"col_no":12}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":712,"line_no":38,"col_no":13}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":713,"line_no":38,"col_no":14}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":714,"line_no":38,"col_no":15}}'
            - '{"type":"keyword","value":"list","pos":{"byte_no":718,"line_no":38,"col_no":19}}'
            - '{"type":"type-arg-list-start","value":"\u003c","pos":{"byte_no":719,"line_no":38,"col_no":20}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":723,"line_no":38,"col_no":24}}'
            - '{"type":"type-arg-list-end","value":"\u003e","pos":{"byte_no":724,"line_no":38,"col_no":25}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":725,"line_no":38,"col_no":26}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":729,"line_no":39,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":732,"line_no":39,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":733,"line_no":39,"col_no":8}}'
            - '{"type":"identifier","value":"Get","pos":{"byte_no":736,"line_no":39,"col_no":11}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":737,"line_no":39,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":743,"line_no":39,"col_no":18}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":744,"line_no":39,"col_no":19}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":745,"line_no":39,"col_no":20}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":749,"line_no":39,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":750,"line_no":39,"col_no":25}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":754,"line_no":40,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":757,"line_no":40,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":758,"line_no":40,"col_no":8}}'
            - '{"type":"identifier","value":"Put","pos":{"byte_no":761,"line_no":40,"col_no":11}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":762,"line_no":40,"col_no":12}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":768,"line_no":40,"col_no":18}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":769,"line_no":40,"col_no":19}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":770,"line_no":40,"col_no":20}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":774,"line_no":40,"col_no":24}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":775,"line_no":40,"col_no":25}}'
            - '{"type":"whitespace","value":"    ","pos":{"byte_no":779,"line_no":41,"col_no":4}}'
            - '{"type":"keyword","value":"rpc","pos":{"byte_no":782,"line_no":41,"col_no":7}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":783,"line_no":41,"col_no":8}}'
            - '{"type":"identifier","value":"Delete","pos":{"byte_no":789,"line_no":41,"col_no":14}}'
            - '{"type":"arg-list-start","value":"(","pos":{"byte_no":790,"line_no":41,"col_no":15}}'
            - '{"type":"keyword","value":"string","pos":{"byte_no":796,"line_no":41,"col_no":21}}'
            - '{"type":"arg-list-end","value":")","pos":{"byte_no":797,"line_no":41,"col_no":22}}'
            - '{"type":"whitespace","value":" ","pos":{"byte_no":798,"line_no":41,"col_no":23}}'
            - '{"type":"identifier","value":"Item","pos":{"byte_no":802,"line_no":41,"col_no":27}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":803,"line_no":41,"col_no":28}}'
            - '{"type":"block-end","value":"}","pos":{"byte_no":804,"line_no":42,"col_no":1}}'
            - '{"type":"end-of-line","value":"\n","pos":{"byte_no":805,"line_no":42,"col_no":2}}'
            - '{"type":"end-of-file","value":"","pos":{"byte_no":805,"line_no":43,"col_no":0}}'
        - name: stderr
          data:
            - ""
- name: ./smoketests.yml \ Basics \ Parsing
  commands:
    - command: go install -v ..
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -parse todo-simple.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - '{'
            - '  "name": "root",'
            - '  "children": null,'
            - '  "options": {'
            - '    "encoding": "json",'
            - '    "go_package": "minitodo",'
            - '    "ruby_module": "minitodo",'
            - '    "transport": "http"'
            - '  },'
            - '  "types": {'
            - '    "Failure": {'
            - '      "name": "Failure",'
            - '      "properties": {'
            - '        "code": {'
            - '          "name": "code",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "description": {'
            - '          "name": "description",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        }'
            - '      }'
            - '    },'
            - '    "TodoItem": {'
            - '      "name": "TodoItem",'
            - '      "properties": {'
            - '        "completed": {'
            - '          "name": "completed",'
            - '          "type": {'
            - '            "name": "bool",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "ctime": {'
            - '          "name": "ctime",'
            - '          "type": {'
            - '            "name": "time",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "description": {'
            - '          "name": "description",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "uuid": {'
            - '          "name": "uuid",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        }'
            - '      }'
            - '    }'
            - '  },'
            - '  "rpcs": {'
            - '    "Delete": {'
            - '      "name": "Delete",'
            - '      "input": ['
            - '        {'
            - '          "name": "string",'
            - '          "arguments": null'
            - '        }'
            - '      ],'
            - '      "output": ['
            - '        {'
            - '          "name": "TodoItem",'
            - '          "arguments": null'
            - '        }'
            - '      ]'
            - '    },'
            - '    "Get": {'
            - '      "name": "Get",'
            - '      "input": ['
            - '        {'
            - '          "name": "string",'
            - '          "arguments": null'
            - '        }'
            - '      ],'
            - '      "output": ['
            - '        {'
            - '          "name": "TodoItem",'
            - '          "arguments": null'
            - '        }'
            - '      ]'
            - '    },'
            - '    "List": {'
            - '      "name": "List",'
            - '      "input": null,'
            - '      "output": ['
            - '        {'
            - '          "name": "list",'
            - '          "arguments": ['
            - '            {'
            - '              "name": "TodoItem",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        }'
            - '      ]'
            - '    },'
            - '    "Put": {'
            - '      "name": "Put",'
            - '      "input": ['
            - '        {'
            - '          "name": "TodoItem",'
            - '          "arguments": null'
            - '        }'
            - '      ],'
            - '      "output": ['
            - '        {'
            - '          "name": "TodoItem",'
            - '          "arguments": null'
            - '        }'
            - '      ]'
            - '    }'
            - '  }'
            - '}'
        - name: stderr
          data:
            - ""
    - command: $(go env GOPATH)/bin/rpc -parse todo-complex.rpc
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - '{'
            - '  "name": "root",'
            - '  "children": {'
            - '    "System": {'
            - '      "name": "System",'
            - '      "children": {'
            - '        "Auth": {'
            - '          "name": "Auth",'
            - '          "children": null,'
            - '          "options": null,'
            - '          "types": {'
            - '            "AuthRequest": {'
            - '              "name": "AuthRequest",'
            - '              "properties": {'
            - '                "authData": {'
            - '                  "name": "authData",'
            - '                  "type": {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                },'
            - '                "provider": {'
            - '                  "name": "provider",'
            - '                  "type": {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                },'
            - '                "username": {'
            - '                  "name": "username",'
            - '                  "type": {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                }'
            - '              }'
            - '            },'
            - '            "AuthResponse": {'
            - '              "name": "AuthResponse",'
            - '              "properties": {'
            - '                "failure": {'
            - '                  "name": "failure",'
            - '                  "type": {'
            - '                    "name": "Failure",'
            - '                    "arguments": null'
            - '                  }'
            - '                },'
            - '                "user": {'
            - '                  "name": "user",'
            - '                  "type": {'
            - '                    "name": "User",'
            - '                    "arguments": null'
            - '                  }'
            - '                }'
            - '              }'
            - '            },'
            - '            "User": {'
            - '              "name": "User",'
            - '              "properties": {'
            - '                "email": {'
            - '                  "name": "email",'
            - '                  "type": {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                },'
            - '                "metadata": {'
            - '                  "name": "metadata",'
            - '                  "type": {'
            - '                    "name": "map",'
            - '                    "arguments": ['
            - '                      {'
            - '                        "name": "string",'
            - '                        "arguments": null'
            - '                      },'
            - '                      {'
            - '                        "name": "string",'
            - '                        "arguments": null'
            - '                      }'
            - '                    ]'
            - '                  }'
            - '                },'
            - '                "username": {'
            - '                  "name": "username",'
            - '                  "type": {'
            - '                    "name": "string",'
            - '                    "arguments": null'
            - '                  }'
            - '                }'
            - '              }'
            - '            }'
            - '          },'
            - '          "rpcs": null'
            - '        }'
            - '      },'
            - '      "options": null,'
            - '      "types": null,'
            - '      "rpcs": {'
            - '        "Status": {'
            - '          "name": "Status",'
            - '          "input": null,'
            - '          "output": ['
            - '            {'
            - '              "name": "Failure",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        }'
            - '      }'
            - '    },'
            - '    "Todos": {'
            - '      "name": "Todos",'
            - '      "children": null,'
            - '      "options": null,'
            - '      "types": {'
            - '        "Item": {'
            - '          "name": "Item",'
            - '          "properties": {'
            - '            "completed": {'
            - '              "name": "completed",'
            - '              "type": {'
            - '                "name": "bool",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "ctime": {'
            - '              "name": "ctime",'
            - '              "type": {'
            - '                "name": "time",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "description": {'
            - '              "name": "description",'
            - '              "type": {'
            - '                "name": "string",'
            - '                "arguments": null'
            - '              }'
            - '            },'
            - '            "id": {'
            - '              "name": "id",'
            - '              "type": {'
            - '                "name": "string",'
            - '                "arguments": null'
            - '              }'
            - '            }'
            - '          }'
            - '        }'
            - '      },'
            - '      "rpcs": {'
            - '        "Delete": {'
            - '          "name": "Delete",'
            - '          "input": ['
            - '            {'
            - '              "name": "string",'
            - '              "arguments": null'
            - '            }'
            - '          ],'
            - '          "output": ['
            - '            {'
            - '              "name": "Item",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        },'
            - '        "Get": {'
            - '          "name": "Get",'
            - '          "input": ['
            - '            {'
            - '              "name": "string",'
            - '              "arguments": null'
            - '            }'
            - '          ],'
            - '          "output": ['
            - '            {'
            - '              "name": "Item",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        },'
            - '        "List": {'
            - '          "name": "List",'
            - '          "input": null,'
            - '          "output": ['
            - '            {'
            - '              "name": "list",'
            - '              "arguments": ['
            - '                {'
            - '                  "name": "Item",'
            - '                  "arguments": null'
            - '                }'
            - '              ]'
            - '            }'
            - '          ]'
            - '        },'
            - '        "Put": {'
            - '          "name": "Put",'
            - '          "input": ['
            - '            {'
            - '              "name": "string",'
            - '              "arguments": null'
            - '            }'
            - '          ],'
            - '          "output": ['
            - '            {'
            - '              "name": "Item",'
            - '              "arguments": null'
            - '            }'
            - '          ]'
            - '        }'
            - '      }'
            - '    }'
            - '  },'
            - '  "options": {'
            - '    "go_import": "github.com/chakrit/rpc/examples",'
            - '    "go_package": "examples"'
            - '  },'
            - '  "types": {'
            - '    "Failure": {'
            - '      "name": "Failure",'
            - '      "properties": {'
            - '        "code": {'
            - '          "name": "code",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        },'
            - '        "description": {'
            - '          "name": "description",'
            - '          "type": {'
            - '            "name": "string",'
            - '            "arguments": null'
            - '          }'
            - '        }'
            - '      }'
            - '    }'
            - '  },'
            - '  "rpcs": null'
            - '}'
        - name: stderr
          data:
            - ""
